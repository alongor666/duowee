# ğŸ“Œ è¾¹é™…è´¡çŒ®ç‡ | `marginal_contribution_ratio`

---

## 1. æŒ‡æ ‡å®šä¹‰
- **å­—æ®µå**ï¼š`marginal_contribution_ratio`  
- **å•ä½**ï¼šå°æ•°  
- **ç±»å‹ï¼ˆDB å­˜å‚¨ï¼‰**ï¼š`numeric(10,6)`ï¼ˆå­˜åº“ä¸ºå°æ•°ï¼Œä¾‹ï¼š0.3478ï¼‰  
- **å±•ç¤ºç²¾åº¦**ï¼šä¿ç•™ 1 ä½å°æ•°  
- **å«ä¹‰**ï¼šåœ¨ç»Ÿè®¡æœŸå†…ï¼Œä¿è´¹æ”¶å…¥æ‰£é™¤å˜åŠ¨æˆæœ¬åçš„æ¯”ä¾‹ï¼Œè¡¡é‡ä¸šåŠ¡çš„ç›ˆåˆ©ç©ºé—´ã€‚  
  - å˜åŠ¨æˆæœ¬åŒ…æ‹¬ï¼šèµ”æ¬¾ï¼ˆ`total_claim_payment_in_10k`ï¼‰ä¸è´¹ç”¨ï¼ˆ`row_expense_amount_in_10k`ï¼‰ã€‚  
  - æœ¬æŒ‡æ ‡ä½“ç°äº†ä¸šåŠ¡åœ¨æ‰¿æ‹…é£é™©ä¸è´¹ç”¨åçš„â€œä½™é‡â€ï¼Œå³å…¬å¸å¯ç”¨äºå¼¥è¡¥å›ºå®šæˆæœ¬å’Œåˆ›é€ åˆ©æ¶¦çš„éƒ¨åˆ†ã€‚  

---

## 2. è®¡ç®—å…¬å¼ï¼ˆå…¬å¸ç»Ÿä¸€å£å¾„ï¼Œæ¨å¯¼ï¼‰
è¡¨æ ¼ä¸­ `marginal_contribution_ratio` å·²ç›´æ¥æä¾›ï¼Œå¯ç”¨äºå–æ•°ï¼›åŒæ—¶ä¹Ÿå¯é€šè¿‡ä»¥ä¸‹å…¬å¼æ¨å¯¼ï¼š  

```text
è¾¹é™…è´¡çŒ®ç‡ (marginal_contribution_ratio) = ( 1 â€“ variable_cost_ratio )

å…¶ä¸­ï¼š
	â€¢	variable_cost_ratioï¼ˆå˜åŠ¨æˆæœ¬ç‡ï¼Œå­˜åº“ä¸ºå°æ•°ï¼‰
	â€¢	è¾¹é™…è´¡çŒ®ç‡ä¸å˜åŠ¨æˆæœ¬ç‡ä¸ºäº’è¡¥å…³ç³»

â¸»

3. è®¡ç®—é¡ºåº
	1.	è®¡ç®— variable_cost_ratioï¼š

variable_cost_ratio = ( SUM(row_expense_amount_in_10k) Ã· SUM(documented_premium_in_10k) )
                    + ( SUM(total_claim_payment_in_10k) Ã· SUM(expired_net_premium_in_10k) )

ï¼ˆå­˜åº“ä¸ºå°æ•°ï¼‰

	2.	è®¡ç®—è¾¹é™…è´¡çŒ®ç‡ï¼š
	â€¢	marginal_contribution_ratio = 1 â€“ variable_cost_ratio
	3.	å­˜åº“å£å¾„ï¼šnumeric(10,6)ï¼ˆå°æ•°å½¢å¼ï¼‰ï¼›
æŠ¥è¡¨å±•ç¤ºæ—¶ï¼šROUND(marginal_contribution_ratio, 4)ï¼Œä¿ç•™ 4 ä½å°æ•°ã€‚

â¸»

4. æ³¨æ„äº‹é¡¹
	â€¢	å£å¾„å›ºå®šï¼šè¾¹é™…è´¡çŒ®ç‡å¿…é¡»ä»¥ 1 â€“ å˜åŠ¨æˆæœ¬ç‡ è¡¨ç¤ºï¼Œä¸å¯ç›´æ¥ç”¨è¾¹é™…è´¡çŒ®é¢/ä¿è´¹æ›¿ä»£ã€‚
	â€¢	å¼‚å¸¸å€¼å¤„ç†ï¼š
	â€¢	è‹¥ variable_cost_ratio > 1ï¼Œåˆ™è¾¹é™…è´¡çŒ®ç‡å¯èƒ½ä¸ºè´Ÿå€¼ï¼Œéœ€ç»“åˆä¸šåŠ¡åœºæ™¯åˆ†æã€‚
	â€¢	ç¡®ä¿ variable_cost_ratio çš„è®¡ç®—é€»è¾‘å·²æ­£ç¡®è½å®ã€‚
	â€¢	å…³è”å…³ç³»ï¼š
	â€¢	ä¸ marginal_contribution_amount_in_10k ç›´æ¥ç›¸å…³ï¼š

marginal_contribution_amount_in_10k = expired_net_premium_in_10k Ã— marginal_contribution_ratio



â¸»

5. å®ç°ç¤ºä¾‹ï¼ˆPostgres / Supabase SQLï¼‰

WITH base AS (
  SELECT
    policy_start_year,
    week_number,
    third_level_organization,
    SUM(row_expense_amount_in_10k)      AS sum_expense_amount,
    SUM(documented_premium_in_10k)      AS sum_doc_premium,
    SUM(total_claim_payment_in_10k)     AS sum_claim_payment,
    SUM(expired_net_premium_in_10k)     AS sum_expired_premium
  FROM auto_insurance_metrics
  GROUP BY 1,2,3
),
calc AS (
  SELECT
    policy_start_year,
    week_number,
    third_level_organization,
    ( (sum_expense_amount / NULLIF(sum_doc_premium,0)) 
    + (sum_claim_payment / NULLIF(sum_expired_premium,0)) ) AS variable_cost_ratio
  FROM base
)
SELECT
  policy_start_year,
  week_number,
  third_level_organization,
  ROUND((1 - variable_cost_ratio), 4) AS marginal_contribution_ratio
FROM calc
ORDER BY policy_start_year, week_number, third_level_organization;


â¸»

6. å£å¾„è¯´æ˜
	â€¢	å…¬å¸å£å¾„ï¼ˆå·²ç»Ÿä¸€å¤šå¹´ï¼‰ï¼š

è¾¹é™…è´¡çŒ®ç‡ = 1 â€“ å˜åŠ¨æˆæœ¬ç‡


	â€¢	å±•ç¤ºå±‚ï¼šå°æ•°å½¢å¼ï¼Œä¿ç•™ 4 ä½å°æ•°ï¼ˆå¦‚ 0.2834ï¼‰ã€‚
	â€¢	è¡Œä¸šå¯¹æ¯”ï¼šè¾¹é™…è´¡çŒ®ç‡å¸¸ç”¨äºè¯„ä¼°ä¸šåŠ¡è´¨é‡ï¼Œä¸ç»¼åˆæˆæœ¬ç‡äº’ä¸ºè¡¥å……ï¼›é«˜è¾¹é™…è´¡çŒ®ç‡æ„å‘³ç€ä¸šåŠ¡èƒ½å¤Ÿæ›´å¥½åœ°è¦†ç›–è´¹ç”¨å¹¶å½¢æˆåˆ©æ¶¦ç©ºé—´ã€‚