# ğŸ“Œ æ»¡æœŸèµ”ä»˜ç‡ | `expired_loss_ratio`

---

## 1. æŒ‡æ ‡å®šä¹‰
- **å­—æ®µå**ï¼š`expired_loss_ratio`  
- **å•ä½**ï¼šå°æ•°  
- **ç±»å‹ï¼ˆDB å­˜å‚¨ï¼‰**ï¼š`numeric(10,6)`ï¼ˆä»¥å°æ•°å½¢å¼å­˜å‚¨ï¼Œå¦‚ 0.6534ï¼‰  
- **å±•ç¤ºç²¾åº¦**ï¼šä¿ç•™ 1 ä½å°æ•°  
- **å«ä¹‰**ï¼šåœ¨ç»Ÿè®¡æœŸå†…ï¼Œç´¯è®¡**æ»¡æœŸå‡€ä¿è´¹**å¯¹åº”çš„å®é™…èµ”ä»˜æ°´å¹³ã€‚è¡¡é‡å…¬å¸æ‰¿ä¿ä¸šåŠ¡åœ¨å·²æ‰¿æ‹…è´£ä»»èŒƒå›´å†…çš„é£é™©æˆæœ¬ï¼Œåæ˜ ç›ˆåˆ©èƒ½åŠ›ä¸é£é™©æ§åˆ¶æ•ˆæœã€‚  

---

## 2. è®¡ç®—å…¬å¼ï¼ˆå…¬å¸å£å¾„ï¼‰
è¡¨æ ¼ä¸­å·²ç›´æ¥æä¾› `expired_loss_ratio`ï¼Œå¯ç›´æ¥å–å€¼ï¼›åŒæ—¶å¯ç”¨ä»¥ä¸‹å…¬å¼è¿›è¡Œæ ¡æ ¸ï¼š  

```text
æ»¡æœŸèµ”ä»˜ç‡ (expired_loss_ratio) = 
    ( SUM(total_claim_payment_in_10k) Ã· SUM(expired_net_premium_in_10k) )

	â€¢	total_claim_payment_in_10kï¼šç´¯è®¡æ€»èµ”æ¬¾ï¼Œä¸‡å…ƒ
	â€¢	expired_net_premium_in_10kï¼šç´¯è®¡æ»¡æœŸå‡€ä¿è´¹ï¼Œä¸‡å…ƒ

â¸»

3. è®¡ç®—é¡ºåº
	1.	èšåˆç»å¯¹å€¼ï¼š
	â€¢	sum_claim_payment = Î£(total_claim_payment_in_10k)
	â€¢	sum_expired_premium = Î£(expired_net_premium_in_10k)
	2.	è®¡ç®—æ¯”ç‡ï¼š
	â€¢	loss_ratio = sum_claim_payment / sum_expired_premium
	3.	å­˜å‚¨å£å¾„ï¼šå°æ•°ï¼ˆå¦‚ 0.5521ï¼‰ï¼›æŠ¥è¡¨å±•ç¤ºæ—¶ ROUND(loss_ratio, 4)ï¼Œå³å°æ•°ä¿ç•™ 4 ä½å°æ•°ã€‚

â¸»

4. æ³¨æ„äº‹é¡¹
	â€¢	åˆ†æ¯ä¸ºæ»¡æœŸå‡€ä¿è´¹ï¼Œä¸å¯è¯¯ç”¨ documented_premium_in_10kã€‚
	â€¢	æ•°æ®å®Œæ•´æ€§ï¼šç¡®ä¿ total_claim_payment_in_10k å·²åŒ…å«æ‰€æœ‰å·²å†³èµ”æ¬¾ï¼Œä¸”æ— é‡å¤æˆ–ç¼ºæ¼ã€‚
	â€¢	è¾¹ç•Œæ¡ä»¶ï¼šè‹¥ expired_net_premium_in_10k=0ï¼Œåˆ™ç»“æœåº”ä¸º NULL æˆ– 0ï¼Œé¿å…é™¤é›¶é”™è¯¯ã€‚
	â€¢	å…³ç³»éªŒè¯ï¼š
	â€¢	ä¸ claim_frequencyï¼ˆæ»¡æœŸå‡ºé™©ç‡ï¼‰è¶‹åŠ¿ä¸€è‡´ï¼Œä½†æ•°å€¼å£å¾„ä¸åŒï¼›
	â€¢	ä¸ marginal_contribution_ratioã€variable_cost_ratio æœ‰ç›´æ¥è®¡ç®—å…³ç³»ã€‚

â¸»

5. å®ç°ç¤ºä¾‹ï¼ˆPostgres / Supabase SQLï¼‰

WITH base AS (
  SELECT
    policy_start_year,
    week_number,
    third_level_organization,
    SUM(total_claim_payment_in_10k) AS sum_claim_payment,
    SUM(expired_net_premium_in_10k) AS sum_expired_premium
  FROM auto_insurance_metrics
  GROUP BY 1,2,3
)
SELECT
  policy_start_year,
  week_number,
  third_level_organization,
  CASE 
    WHEN sum_expired_premium > 0
      THEN ROUND((sum_claim_payment / sum_expired_premium), 4)
    ELSE NULL
  END AS expired_loss_ratio
FROM base
ORDER BY policy_start_year, week_number, third_level_organization;


â¸»

6. å£å¾„è¯´æ˜
	â€¢	å…¬å¸å£å¾„ï¼šæ»¡æœŸèµ”ä»˜ç‡ = æ€»èµ”æ¬¾ï¼ˆä¸‡å…ƒï¼‰ Ã· æ»¡æœŸå‡€ä¿è´¹ï¼ˆä¸‡å…ƒï¼‰ã€‚
	â€¢	è¡Œä¸šå¯¹æ¯”ï¼šä¸ç›‘ç®¡æŠ¥è¡¨ä¸­çš„â€œèµ”ä»˜ç‡ï¼ˆå·²èµšä¿è´¹å£å¾„ï¼‰â€å®šä¹‰ä¸€è‡´ï¼Œèƒ½è¡¡é‡å·²æ‰¿æ‹…é£é™©éƒ¨åˆ†çš„çœŸå®èµ”ä»˜æ°´å¹³ã€‚