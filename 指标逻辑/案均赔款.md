# 📌 案均赔款 | `average_claim_payment`

---

## 1. 指标定义
- **字段名**：`average_claim_payment`  
- **单位**：元  
- **类型（DB 存储）**：`numeric(18,4)`  
- **展示精度**：保留 1 位小数  
- **含义**：在统计期内，**每个赔付案件平均支付的赔款金额**。用于衡量单案赔付水平，反映赔案的平均成本大小。  

---

## 2. 计算公式（公司口径）
表格已直接提供该指标，但可通过推导公式校核：  

```text
average_claim_payment(元) = ( total_claim_payment_in_10k × 10000 ) ÷ case_count

	•	total_claim_payment_in_10k：累计总赔款，万元
	•	case_count：赔案件数，件（推导或统计得到）

⸻

3. 计算顺序
	1.	计算总赔款（元）：
	•	sum_claim_payment_yuan = SUM(total_claim_payment_in_10k) * 10000
	2.	计算赔案件数：
	•	sum_case_count = SUM(case_count)（需推导或直接获取）
	3.	计算案均赔款：
	•	avg_claim_payment = sum_claim_payment_yuan / sum_case_count
	4.	存储口径：numeric(18,4)；报表展示时 ROUND(avg_claim_payment,1)，保留 1 位小数。

⸻

4. 注意事项
	•	数据口径：本指标以 赔案件数 为分母，不能用“报案件数”代替。
	•	数据源限制：当前表格已直接提供 average_claim_payment，但因缺少原始案件明细，可能存在偏差。需定期与理赔系统核对。
	•	边界条件：当 case_count=0 时，返回 NULL 或 0，避免除零错误。

⸻

5. 实现示例（Postgres / Supabase SQL）

WITH base AS (
  SELECT
    policy_start_year,
    week_number,
    third_level_organization,
    SUM(total_claim_payment_in_10k) * 10000 AS sum_claim_payment_yuan,
    SUM(case_count) AS sum_case_count
  FROM auto_insurance_metrics
  GROUP BY 1,2,3
)
SELECT
  policy_start_year,
  week_number,
  third_level_organization,
  CASE 
    WHEN sum_case_count > 0 
      THEN ROUND(sum_claim_payment_yuan::numeric / sum_case_count, 1)
    ELSE NULL
  END AS average_claim_payment
FROM base
ORDER BY policy_start_year, week_number, third_level_organization;


⸻

6. 稽核与诊断提示
	•	与 total_claim_payment_in_10k、case_count 交叉校验：

total_claim_payment_in_10k × 10000 ≈ average_claim_payment × case_count


	•	若差异较大，说明源数据口径可能存在“案件数统计不完整”或“赔付金额包含未决/撤销”。

⸻

7. 口径说明
	•	公司口径：案均赔款 = 总赔款（元） ÷ 赔案件数（件）。
	•	行业对比：行业通行口径一致，用于衡量单案赔付成本水平，是风险定价和理赔管控的关键指标。