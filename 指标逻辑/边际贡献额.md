# 📌 边际贡献额 | `marginal_contribution_amount_in_10k`

---

## 1. 指标定义
- **字段名**：`marginal_contribution_amount_in_10k`  
- **单位**：万元  
- **类型（DB 存储）**：`numeric(18,4)`  
- **展示精度**：保留 1 位小数  
- **含义**：在统计期内，业务在满期净保费中扣除变动成本（赔款 + 费用）后，所形成的**可用于覆盖固定成本与创造利润的金额**。反映业务在风险成本与费用之后的剩余盈利能力。  

---

## 2. 计算公式（公司统一口径，推导）
表格中 `marginal_contribution_amount_in_10k` 已提供，但需通过公式推导校核：  

```text
边际贡献额 (marginal_contribution_amount_in_10k, 万元) =
    SUM(expired_net_premium_in_10k) × marginal_contribution_ratio

其中：
	•	expired_net_premium_in_10k：累计满期净保费（万元）
	•	marginal_contribution_ratio：边际贡献率，小数形式存储（0.2345 表示 23.45%）

⸻

3. 计算顺序
	1.	计算变动成本率：

variable_cost_ratio = ( SUM(row_expense_amount_in_10k) ÷ SUM(documented_premium_in_10k) )
                    + ( SUM(total_claim_payment_in_10k) ÷ SUM(expired_net_premium_in_10k) )


	2.	计算边际贡献率：

marginal_contribution_ratio = 1 – variable_cost_ratio


	3.	计算边际贡献额：

marginal_contribution_amount_in_10k = SUM(expired_net_premium_in_10k) × marginal_contribution_ratio


	4.	存储口径：numeric(18,4)（万元）；
报表展示时 ROUND(marginal_contribution_amount_in_10k,1)，保留 1 位小数。

⸻

4. 注意事项
	•	依赖指标：必须先计算 variable_cost_ratio → marginal_contribution_ratio，再得到 marginal_contribution_amount_in_10k。
	•	单位一致性：分母与分子需保持在万元口径，避免因换算遗漏导致偏差。
	•	结果特征：
	•	结果可为正或负：负值表示满期净保费不足以覆盖赔付+费用，业务处于亏损状态；
	•	正值表示存在可供覆盖固定成本与利润的空间。
	•	校核关系：

marginal_contribution_amount_in_10k ÷ expired_net_premium_in_10k ≈ marginal_contribution_ratio



⸻

5. 实现示例（Postgres / Supabase SQL）

WITH base AS (
  SELECT
    policy_start_year,
    week_number,
    third_level_organization,
    SUM(row_expense_amount_in_10k)      AS sum_expense_amount,
    SUM(documented_premium_in_10k)      AS sum_doc_premium,
    SUM(total_claim_payment_in_10k)     AS sum_claim_payment,
    SUM(expired_net_premium_in_10k)     AS sum_expired_premium
  FROM auto_insurance_metrics
  GROUP BY 1,2,3
),
calc AS (
  SELECT
    policy_start_year,
    week_number,
    third_level_organization,
    ( (sum_expense_amount / NULLIF(sum_doc_premium,0)) 
    + (sum_claim_payment / NULLIF(sum_expired_premium,0)) ) AS variable_cost_ratio,
    sum_expired_premium
  FROM base
)
SELECT
  policy_start_year,
  week_number,
  third_level_organization,
  CASE 
    WHEN sum_expired_premium > 0
      THEN ROUND(sum_expired_premium * (1 - variable_cost_ratio), 1)
    ELSE NULL
  END AS marginal_contribution_amount_in_10k
FROM calc
ORDER BY policy_start_year, week_number, third_level_organization;


⸻

6. 口径说明
	•	公司口径：

边际贡献额 = 满期净保费 × 边际贡献率


	•	展示层：保留 1 位小数（万元）；
	•	行业对比：边际贡献额相当于“已赚保费 – 赔款 – 费用”，是经营质量和盈利能力的核心指标。