# 📌 费用金额 | `row_expense_amount_in_10k`

---

## 1. 指标定义
- **字段名**：`row_expense_amount_in_10k`  
- **单位**：万元  
- **类型（DB 存储）**：`numeric(18,4)`  
- **展示精度**：保留 1 位小数  
- **含义**：在统计期内，根据签单保费和费用率推导出的**累计费用金额**，用于反映业务在获取与维系过程中的费用消耗。该字段为**推导字段**，非原始数据。  

---

## 2. 计算公式（公司统一口径，推导）
```text
费用金额 (row_expense_amount_in_10k, 万元) =
    documented_premium_in_10k × expense_ratio

其中：
	•	documented_premium_in_10k：累计签单保费（万元）
	•	expense_ratio：费用率，小数形式存储（如 0.2134 表示 21.34%）

⸻

3. 计算顺序
	1.	获取每个维度下的 documented_premium_in_10k（万元）；
	2.	获取对应的 expense_ratio（小数口径）；
	3.	逐行计算：
	•	row_expense_amount_in_10k = documented_premium_in_10k × expense_ratio
	4.	聚合时：
	•	sum_expense_amount = Σ(row_expense_amount_in_10k)
	5.	存库口径：numeric(18,4)（万元）；
报表展示时：ROUND(row_expense_amount_in_10k, 1)。

⸻

4. 注意事项
	•	推导性质：本字段并非原始提供，而是根据“签单保费 × 费用率”推算得出。
	•	单位保持一致：因 documented_premium_in_10k 已是万元，直接与 expense_ratio 相乘即可，无需额外换算。
	•	数据准确性：需确认 expense_ratio 来源正确，且为小数（如 0.25 表示 25%），避免当作百分数直接相乘。
	•	关联关系：
	•	expense_ratio = Σ(row_expense_amount_in_10k) ÷ Σ(documented_premium_in_10k)
	•	variable_cost_ratio、marginal_contribution_ratio 等指标均依赖本字段。

⸻

5. 实现示例（Postgres / Supabase SQL）

SELECT
  policy_start_year,
  week_number,
  third_level_organization,
  documented_premium_in_10k,
  expense_ratio,
  ROUND(documented_premium_in_10k * expense_ratio, 1) AS row_expense_amount_in_10k
FROM auto_insurance_metrics;


⸻

6. 口径说明
	•	公司口径（已统一多年）：费用金额基于签单保费 × 费用率推导，口径固定，便于后续计算费用率、变动成本率。
	•	展示层：保留 1 位小数（万元）。
	•	行业对比：行业中“费用支出”常直接取自费用报表，而本项目因数据源为加工表，采用推导方式计算，更适合与签单口径挂钩。