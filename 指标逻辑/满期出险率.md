# ğŸ“Œ æ»¡æœŸå‡ºé™©ç‡ | `claim_frequency`

---

## 1. æŒ‡æ ‡å®šä¹‰
- **å­—æ®µå**ï¼š`claim_frequency`  
- **å•ä½**ï¼šå°æ•°  
- **ç±»å‹ï¼ˆDB å­˜å‚¨ï¼‰**ï¼š`numeric(10,6)`ï¼ˆå­˜åº“ä¸ºå°æ•°ï¼Œä¾‹ï¼š0.123456ï¼‰  
- **å±•ç¤ºç²¾åº¦**ï¼šä¿ç•™ 1 ä½å°æ•°  
- **å«ä¹‰**ï¼šåœ¨ç»Ÿè®¡æœŸå†…ï¼Œåæ˜ æ¯å¼ ä¿å•åœ¨æ»¡æœŸè´£ä»»èŒƒå›´å†…å‘ç”Ÿèµ”æ¡ˆçš„é¢‘ç‡ã€‚ä¸å•çº¯â€œæŠ¥æ¡ˆä»¶æ•°/ä¿å•ä»¶æ•°â€çš„è®¡ç®—ä¸åŒï¼Œæœ¬å…¬å¸å£å¾„å¼•å…¥ **æ»¡æœŸå‡€ä¿è´¹ / è·Ÿå•ä¿è´¹** çš„ä¿®æ­£ç³»æ•°ï¼Œæ›´çœŸå®ä½“ç°é£é™©æš´éœ²ç¨‹åº¦ã€‚  

---

## 2. è®¡ç®—å…¬å¼ï¼ˆå…¬å¸ç»Ÿä¸€å£å¾„ï¼‰

```text
æ»¡æœŸå‡ºé™©ç‡ (claim_frequency) =
    ( SUM(case_count) Ã· SUM(policy_count) ) 
  Ã— ( SUM(expired_net_premium_in_10k) Ã· SUM(documented_premium_in_10k) )

å…¶ä¸­ï¼š
	â€¢	case_countï¼ˆèµ”æ¡ˆä»¶æ•°ï¼Œä»¶ï¼‰éœ€æ¨å¯¼ï¼š

case_count = ( total_claim_payment_in_10k Ã— 10000 ) Ã· average_claim_payment


	â€¢	policy_countï¼ˆä¿å•ä»¶æ•°ï¼Œä»¶ï¼‰éœ€æ¨å¯¼ï¼š

policy_count = ( documented_premium_in_10k Ã— 10000 ) Ã· average_premium_per_policy


	â€¢	expired_net_premium_in_10kï¼ˆæ»¡æœŸå‡€ä¿è´¹ï¼Œä¸‡å…ƒï¼‰
	â€¢	documented_premium_in_10kï¼ˆè·Ÿå•ä¿è´¹ï¼Œä¸‡å…ƒï¼‰

â¸»

3. è®¡ç®—é¡ºåº
	1.	æ¨å¯¼ä»¶æ•°ï¼š
	â€¢	è®¡ç®— case_countã€policy_countã€‚
	2.	èšåˆç»å¯¹å€¼ï¼š
	â€¢	sum_case_count = Î£(case_count)
	â€¢	sum_policy_count = Î£(policy_count)
	â€¢	sum_expired_premium = Î£(expired_net_premium_in_10k)
	â€¢	sum_doc_premium = Î£(documented_premium_in_10k)
	3.	åˆ†æ­¥è®¡ç®—ï¼š
	â€¢	å…ˆç®—æ¡ˆä»¶é¢‘åº¦æ¯”ç‡ï¼šcase_ratio = sum_case_count / sum_policy_count
	â€¢	å†ç®—ä¿è´¹æš´éœ²æ¯”ç‡ï¼špremium_ratio = sum_expired_premium / sum_doc_premium
	4.	åˆå¹¶å¾—å‡ºç»“æœï¼š
	â€¢	claim_frequency = case_ratio Ã— premium_ratio
	â€¢	å­˜åº“ä¸ºå°æ•°ï¼ˆå¦‚ 0.0765ï¼‰ï¼›æŠ¥è¡¨å±•ç¤ºä¸º 0.0765ã€‚

â¸»

4. æ³¨æ„äº‹é¡¹
	â€¢	å•ä½æ¢ç®—ï¼šæ¶‰åŠé‡‘é¢æ—¶ï¼Œè®°å¾—å°†ä¸‡å…ƒè½¬æ¢ä¸ºå…ƒå†è¿›è¡Œæ¨å¯¼ä»¶æ•°ã€‚
	â€¢	åˆ†æ¯é™åˆ¶ï¼šè‹¥ policy_count=0 æˆ– documented_premium_in_10k=0ï¼Œåˆ™ç»“æœç½®ä¸º NULLã€‚
	â€¢	æ•°æ®å£å¾„ï¼š
	â€¢	ä½¿ç”¨ èµ”æ¡ˆä»¶æ•°ï¼ˆcase_countï¼‰è€ŒéæŠ¥æ¡ˆä»¶æ•°ï¼›
	â€¢	å¿…é¡»ç»“åˆä¿è´¹æš´éœ²æ¯”ä¾‹ (æ»¡æœŸå‡€ä¿è´¹ / è·Ÿå•ä¿è´¹)ã€‚
	â€¢	æ ¡æ ¸æ–¹æ³•ï¼š
	â€¢	æ£€æŸ¥ (case_count Ã— average_claim_payment) / 10000 â‰ˆ total_claim_payment_in_10k æ˜¯å¦ä¸€è‡´ï¼›
	â€¢	å¯¹æ¯” claim_frequency ä¸ expired_loss_ratio çš„è¶‹åŠ¿æ˜¯å¦åŒ¹é…ï¼ˆèµ”ä»˜ç‡é«˜çš„ä¸šåŠ¡å‡ºé™©ç‡é€šå¸¸ä¹Ÿé«˜ï¼‰ã€‚

â¸»

5. å®ç°ç¤ºä¾‹ï¼ˆPostgres / Supabase SQLï¼‰

WITH base AS (
  SELECT
    policy_start_year,
    week_number,
    third_level_organization,
    SUM((total_claim_payment_in_10k * 10000) / NULLIF(average_claim_payment,0)) AS sum_case_count,
    SUM((documented_premium_in_10k * 10000) / NULLIF(average_premium_per_policy,0)) AS sum_policy_count,
    SUM(expired_net_premium_in_10k) AS sum_expired_premium,
    SUM(documented_premium_in_10k)  AS sum_doc_premium
  FROM auto_insurance_metrics
  GROUP BY 1,2,3
)
SELECT
  policy_start_year,
  week_number,
  third_level_organization,
  CASE 
    WHEN sum_policy_count > 0 AND sum_doc_premium > 0
      THEN ROUND(( (sum_case_count / sum_policy_count) * (sum_expired_premium / sum_doc_premium) ), 4)
    ELSE NULL
  END AS claim_frequency
FROM base
ORDER BY policy_start_year, week_number, third_level_organization;


â¸»

6. å£å¾„è¯´æ˜
	â€¢	å…¬å¸å£å¾„ï¼ˆå·²ç»Ÿä¸€å¤šå¹´ï¼‰ï¼š

æ»¡æœŸå‡ºé™©ç‡ = (èµ”æ¡ˆä»¶æ•° Ã· ä¿å•ä»¶æ•°) Ã— (æ»¡æœŸå‡€ä¿è´¹ Ã· è·Ÿå•ä¿è´¹)


	â€¢	è¡Œä¸šå¯¹æ¯”ï¼š
	â€¢	è¡Œä¸šå†…å¸¸è§â€œå‡ºé™©ç‡â€= å‡ºé™©ä¿å•æ•° Ã· æœ‰æ•ˆä¿å•æ•°ï¼›
	â€¢	æœ¬å…¬å¸å£å¾„é€šè¿‡å¼•å…¥ä¿è´¹æš´éœ²ä¿®æ­£å› å­ï¼Œæ›´ç¬¦åˆå®é™…é£é™©æ‰¿æ‹…ç‰¹å¾ã€‚