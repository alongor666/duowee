# 📌 保费计划 | `premium_plan`

---

## 1. 指标定义
- **字段名**：`premium_plan`  
- **单位**：万元  
- **类型（DB 存储）**：`numeric(18,4)`  
- **展示精度**：保留 1 位小数  
- **来源**：人工录入 / 外部导入  
- **含义**：在统计期内为业务设定的目标保费规模，用于对比实际签单保费并衡量目标达成情况。

---

## 2. 取数口径（公司统一）
```text
premium_plan(万元) = Σ(premium_plan)

该字段为计划值，非计算得出；仅做聚合求和或按层级拆分查看。

⸻

3. 计算关系（用于联动校核）
	•	与 plan_achievement_rate（保费计划达成率）：

plan_achievement_rate = documented_premium_in_10k ÷ premium_plan


	•	与 documented_premium_in_10k（跟单保费）共同用于计划对比分析。

⸻

4. 计算顺序（在使用场景中）
	1.	录入/导入各维度的 premium_plan（万元）。
	2.	在目标统计维度聚合 Σ(premium_plan)。
	3.	与 Σ(documented_premium_in_10k) 进行对比，计算 plan_achievement_rate 并展示。

⸻

5. 注意事项
	•	口径一致：与 documented_premium_in_10k 均为万元口径，便于直接比对。
	•	数据完整性：计划值缺失会导致达成率偏高或无法计算；需建立必填与阈值校验。
	•	时点一致：snapshot_date、policy_start_year、week_number 与计划口径保持一致（同周期/同年度）。
	•	结构匹配：维度（如 third_level_organization、insurance_type）需与实际产生数据一致，否则会出现结构错配。

⸻

6. 实现示例（Postgres / Supabase SQL）

-- 聚合查看各维度的计划值
WITH base AS (
  SELECT
    policy_start_year,
    week_number,
    third_level_organization,
    SUM(premium_plan) AS sum_plan
  FROM auto_insurance_metrics
  GROUP BY 1,2,3
)
SELECT
  policy_start_year,
  week_number,
  third_level_organization,
  ROUND(sum_plan, 1) AS premium_plan
FROM base
ORDER BY policy_start_year, week_number, third_level_organization;


⸻

7. 口径说明
	•	公司口径：premium_plan 为人工设定的目标保费（万元），用于考核与过程管理。
	•	展示层：保留 1 位小数。
	•	配套指标：plan_achievement_rate 用于评估计划完成度，需在 premium_plan > 0 条件下计算。