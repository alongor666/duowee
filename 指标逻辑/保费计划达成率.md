# 📌 保费计划达成率 | `plan_achievement_rate`

---

## 1. 指标定义
- **字段名**：`plan_achievement_rate`  
- **单位**：小数  
- **类型（DB 存储）**：`numeric(10,6)`（存库为小数，例：0.8567）  
- **展示精度**：保留 1 位小数  
- **含义**：衡量当期累计签单保费与计划保费的完成情况，反映业务目标的落实程度与达成进度。  

---

## 2. 计算公式（公司统一口径，推导）
表格中 `plan_achievement_rate` 已提供，但可通过以下公式推导校核：  

```text
保费计划达成率 (plan_achievement_rate) = 
    ( SUM(documented_premium_in_10k) ÷ SUM(premium_plan) )

其中：
	•	documented_premium_in_10k：累计签单保费（万元）
	•	premium_plan：保费计划（万元，人工录入）

⸻

3. 计算顺序
	1.	聚合基础值：
	•	sum_doc_premium = Σ(documented_premium_in_10k)
	•	sum_premium_plan = Σ(premium_plan)
	2.	计算比率：
	•	plan_rate = sum_doc_premium ÷ sum_premium_plan
	3.	存库口径：小数（如 0.9231）；
报表展示时 ROUND(plan_rate, 4)，保留 4 位小数。

⸻

4. 注意事项
	•	数据来源：premium_plan 由人工录入，需定期校核其准确性和完整性。
	•	分母为0时：若 premium_plan=0，则本指标返回 NULL 或 0，避免除零错误。
	•	累计属性：需结合 policy_start_year、week_number 按年累计口径取数。
	•	业务解读：
	•	达成率 ≥100% 表示签单保费超额完成计划；
	•	达成率 <100% 表示未达目标，需要分析差距原因。

⸻

5. 实现示例（Postgres / Supabase SQL）

WITH base AS (
  SELECT
    policy_start_year,
    week_number,
    third_level_organization,
    SUM(documented_premium_in_10k) AS sum_doc_premium,
    SUM(premium_plan)              AS sum_premium_plan
  FROM auto_insurance_metrics
  GROUP BY 1,2,3
)
SELECT
  policy_start_year,
  week_number,
  third_level_organization,
  CASE 
    WHEN sum_premium_plan > 0
      THEN ROUND((sum_doc_premium / sum_premium_plan), 4)
    ELSE NULL
  END AS plan_achievement_rate
FROM base
ORDER BY policy_start_year, week_number, third_level_organization;


⸻

6. 口径说明
	•	公司口径：

保费计划达成率 = 签单保费 ÷ 保费计划


	•	展示层：以小数形式呈现，保留 4 位小数。
	•	行业对比：等同于常见的“计划达成率”，体现计划与实际业务量的匹配程度，常用于考核机构和团队的目标完成情况。