⸻

车险指标修正与文档更新说明（中文版）

一、背景与目的

在前期开发与文档编制过程中，部分指标公式存在逻辑错误或表达不够严谨，尤其是 边际贡献额 与 变动成本率 的计算方式。为确保指标口径一致、计算准确，用户提出三项修订需求，并要求统一落实到所有相关文档与代码中。

⸻

二、主要修订内容

1. 满期边际贡献额（Matured Marginal Contribution）
	•	错误之处：原公式基于“差额计算”，未能准确体现损益结构。
	•	修正公式：
满期边际贡献额 = 满期保费 × (1 - 满期赔付率 - 费用率)
	•	特别说明：
	•	指标名称统一为 满期边际贡献额，不再使用“边际贡献额”简称。
	•	此为“阶段性”计算结果，并非终极边际贡献额。
	•	只有当区间内所有保单满期、所有赔案完全结案后，才能计算 终极边际贡献额。

⸻

2. 变动成本率（Variable Cost Ratio Percent）
	•	统一计算公式：
变动成本率 = (费用金额 ÷ 签单保费) + (已报告赔款 ÷ 满期保费)
	•	说明：
	•	确保分母口径正确，避免因错误聚合导致计算偏差。
	•	明确体现“每单位已满期保单的保费收入对应的变动成本比例”。
	•	已将该公式落实到所有包含 variable_cost_ratio_percent 的 Markdown 文档。

⸻

3. Python 脚本更新

涉及 scripts/convert_excel_to_cleaned_csv.py 与 scripts/restructure_runner_fallback.py，主要修订包括：
	•	字段映射更新：

CN_TO_EN = {
  '跟单保费(万)': 'signed_premium_in_10k',
  '满期净保费(万)': 'matured_premium_in_10k',
  '案件数': 'claim_case_count',
  '总赔款(万)': 'reported_claim_payment_in_10k',
  '满期赔付率': 'matured_loss_ratio',
  '保费计划(万)': 'premium_plan_in_10k',
}


	•	新增计算逻辑：

# 满期边际贡献额计算
res['marginal_contribution_amount_yuan'] = (
    res['matured_premium_yuan'] *
    (1 - matured_loss_ratio - expense_ratio)
)


	•	保证 19 个核心指标（9 个绝对值、7 个比率、2 个均值、1 个系数）全面符合《字段定义与计算规范》。

⸻

三、同步修订范围
	1.	Markdown 文档
	•	指标逻辑/车险字段定义与计算规范.md
	•	指标逻辑/字段对照表.md
	•	CLAUDE.md
	•	prd.md
	•	README.md
	•	AGENTS.md
	•	车险变动成本数据综合说明文档.md
	•	字段分类与筛选项清单.md
	•	AI开发数据说明.md
	2.	前端代码
	•	src/types/metrics.ts
	•	src/services/dataProcessor.ts
	•	src/services/metricCalculator.ts
	3.	Python 脚本
	•	scripts/convert_excel_to_cleaned_csv.py
	•	scripts/restructure_runner_fallback.py

⸻

四、问题修正与成效
	•	✅ 公式逻辑修正：边际贡献额由“差额”改为“率 × 保费”。
	•	✅ 指标口径统一：所有涉及“变动成本率”的文件公式完全一致。
	•	✅ 字段映射更新：中英文字段保持一致，避免调用错误。
	•	✅ 业务逻辑澄清：强调“满期”与“终极”边际贡献额的区别。
	•	✅ 系统一致性：Markdown、TypeScript、Python 三类文件全面同步。

⸻

五、结论

通过本轮修订，系统已完成公式与逻辑的全链路统一，确保数据口径与业务解释高度一致。后续若有新指标或扩展需求，应严格参照 《字段定义与计算规范》 更新，以避免再次出现口径不一致的问题。

⸻