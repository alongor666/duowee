# è½¦é™©å˜åŠ¨æˆæœ¬æ˜ç»†åˆ†æç³»ç»Ÿ - æŠ€æœ¯æ¶æ„è®¾è®¡

> **ä¸»æ–‡æ¡£**: [PRDäº§å“éœ€æ±‚æ–‡æ¡£](../../prd.md) - ğŸ¯ **æ ¸å¿ƒå…¥å£**  
> **æ–‡æ¡£ç´¢å¼•**: [å®Œæ•´æ–‡æ¡£å¯¼èˆª](../index.md)  
> **æœ¬æ–‡æ¡£åœ¨ä¸»PRDä¸­çš„ä½ç½®**: [æŠ€æœ¯å®ç° > æŠ€æœ¯æ¶æ„è¯¦ç»†è¯´æ˜](../../prd.md#ğŸ”§-æŠ€æœ¯å®ç°)
> 
> **ç›¸å…³ç« èŠ‚**: ä¸»PRDç¬¬5ç« ã€ŒæŠ€æœ¯è§„èŒƒã€çš„è¯¦ç»†å±•å¼€

## 1. ç³»ç»Ÿæ¶æ„æ¦‚è§ˆ

### 1.1 æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ç”¨æˆ·å±‚                                â”‚
â”‚   Webæµè§ˆå™¨ â”‚ ç§»åŠ¨ç«¯æµè§ˆå™¨ â”‚ å¹³æ¿æµè§ˆå™¨                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                        å‰ç«¯å±‚                                â”‚
â”‚  Next.js 14 â”‚ TypeScript â”‚ Tailwind CSS â”‚ Recharts        â”‚
â”‚  React Context â”‚ React Hook Form â”‚ React Query             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                        APIç½‘å…³å±‚                             â”‚
â”‚   Nginx â”‚ è´Ÿè½½å‡è¡¡ â”‚ è¯·æ±‚è·¯ç”± â”‚ é™æ€èµ„æºæœåŠ¡               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                        åº”ç”¨æœåŠ¡å±‚                            â”‚
â”‚   Node.js â”‚ Express â”‚ TypeScript â”‚ ä¸šåŠ¡é€»è¾‘å¤„ç†             â”‚
â”‚   æ•°æ®èšåˆ â”‚ KPIè®¡ç®— â”‚ ç¼“å­˜ç®¡ç† â”‚ é”™è¯¯å¤„ç†                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                        æ•°æ®å¤„ç†å±‚                            â”‚
â”‚  CSV Parser â”‚ æ•°æ®éªŒè¯ â”‚ å†…å­˜ç¼“å­˜ â”‚ æ•°æ®è½¬æ¢               â”‚
â”‚  èšåˆè®¡ç®— â”‚ é¢„è¿ç®— â”‚ å¢é‡æ›´æ–° â”‚ æ•°æ®å‹ç¼©                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                        å­˜å‚¨å±‚                                â”‚
â”‚  æœ¬åœ°CSVæ–‡ä»¶ â”‚ æ–‡ä»¶ç³»ç»Ÿ â”‚ ä¸´æ—¶ç¼“å­˜ â”‚ æ—¥å¿—æ–‡ä»¶             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                        åŸºç¡€è®¾æ–½å±‚                            â”‚
â”‚   Docker â”‚ PM2 â”‚ ç›‘æ§å‘Šè­¦ â”‚ æ—¥å¿—æ”¶é›† â”‚ å¤‡ä»½æ¢å¤           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 æ¶æ„ç‰¹ç‚¹

#### è½»é‡åŒ–è®¾è®¡
- **æ— æ•°æ®åº“ä¾èµ–**: ç›´æ¥åŸºäºCSVæ–‡ä»¶ï¼Œé™ä½è¿ç»´å¤æ‚åº¦
- **å†…å­˜è®¡ç®—**: æ•°æ®åŠ è½½åˆ°å†…å­˜è¿›è¡Œé«˜é€Ÿè®¡ç®—
- **æ–‡ä»¶ç³»ç»Ÿå­˜å‚¨**: åˆ©ç”¨æ“ä½œç³»ç»Ÿæ–‡ä»¶ç¼“å­˜æœºåˆ¶

#### é«˜æ€§èƒ½ä¼˜åŒ–
- **åˆ†å±‚ç¼“å­˜**: æµè§ˆå™¨ç¼“å­˜ + åº”ç”¨ç¼“å­˜ + æ–‡ä»¶ç³»ç»Ÿç¼“å­˜
- **é¢„è¿ç®—**: å…³é”®æŒ‡æ ‡é¢„èšåˆï¼Œå‡å°‘å®æ—¶è®¡ç®—
- **å¢é‡åŠ è½½**: æŒ‰æ—¶é—´çª—å£åˆ†ç‰‡åŠ è½½æ•°æ®

#### å¯æ‰©å±•æ€§
- **æ¨¡å—åŒ–è®¾è®¡**: å‰åç«¯åˆ†ç¦»ï¼Œç»„ä»¶åŒ–å¼€å‘
- **APIæ ‡å‡†åŒ–**: RESTfulæ¥å£ï¼Œæ”¯æŒç‰ˆæœ¬ç®¡ç†
- **é…ç½®é©±åŠ¨**: å…³é”®å‚æ•°å¯é…ç½®ï¼Œæ”¯æŒä¸åŒç¯å¢ƒ

## 2. å‰ç«¯æ¶æ„è®¾è®¡

### 2.1 æŠ€æœ¯æ ˆæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        UIç»„ä»¶å±‚                              â”‚
â”‚   é¡µé¢ç»„ä»¶ â”‚ ä¸šåŠ¡ç»„ä»¶ â”‚ åŸºç¡€ç»„ä»¶ â”‚ å›¾è¡¨ç»„ä»¶               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                        çŠ¶æ€ç®¡ç†å±‚                            â”‚
â”‚  React Context â”‚ useReducer â”‚ æœ¬åœ°çŠ¶æ€ â”‚ è¡¨å•çŠ¶æ€          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                        æ•°æ®è¯·æ±‚å±‚                            â”‚
â”‚   React Query â”‚ Axios â”‚ è¯·æ±‚æ‹¦æˆª â”‚ é”™è¯¯å¤„ç†              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                        è·¯ç”±å¯¼èˆªå±‚                            â”‚
â”‚  Next.js Router â”‚ åŠ¨æ€è·¯ç”± â”‚ è·¯ç”±å®ˆå« â”‚ é¡µé¢é¢„åŠ è½½        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                        æ ·å¼ä¸»é¢˜å±‚                            â”‚
â”‚  Tailwind CSS â”‚ CSS Modules â”‚ ä¸»é¢˜å˜é‡ â”‚ å“åº”å¼è®¾è®¡       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                        æ„å»ºå·¥å…·å±‚                            â”‚
â”‚   Webpack 5 â”‚ Babel â”‚ TypeScript â”‚ ESLint â”‚ Prettier      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 ç»„ä»¶æ¶æ„è®¾è®¡

#### é¡µé¢çº§ç»„ä»¶
- **DashboardPage**: ä¸»ä»ªè¡¨æ¿é¡µé¢
- **AnalysisPage**: æ·±åº¦åˆ†æé¡µé¢
- **SettingsPage**: ç³»ç»Ÿè®¾ç½®é¡µé¢

#### ä¸šåŠ¡ç»„ä»¶
- **KPICard**: KPIæŒ‡æ ‡å¡ç‰‡
- **FilterPanel**: ç­›é€‰å™¨é¢æ¿
- **ChartContainer**: å›¾è¡¨å®¹å™¨
- **DataTable**: æ•°æ®è¡¨æ ¼
- **ExportPanel**: å¯¼å‡ºåŠŸèƒ½é¢æ¿

#### åŸºç¡€ç»„ä»¶
- **Button**: æŒ‰é’®ç»„ä»¶
- **Input**: è¾“å…¥æ¡†ç»„ä»¶
- **Select**: ä¸‹æ‹‰é€‰æ‹©ç»„ä»¶
- **Modal**: æ¨¡æ€æ¡†ç»„ä»¶
- **Loading**: åŠ è½½çŠ¶æ€ç»„ä»¶

### 2.3 çŠ¶æ€ç®¡ç†æ¶æ„

```typescript
// å…¨å±€çŠ¶æ€ç»“æ„
interface GlobalState {
  // ç”¨æˆ·çŠ¶æ€
  user: {
    permissions: string[];
    preferences: UserPreferences;
  };
  
  // åº”ç”¨çŠ¶æ€
  app: {
    loading: boolean;
    error: string | null;
    theme: 'light' | 'dark';
  };
  
  // æ•°æ®çŠ¶æ€
  data: {
    filters: FilterState;
    kpis: KPIData[];
    charts: ChartData[];
    cache: CacheState;
  };
  
  // é€‰æ‹©å™¨çŠ¶æ€
  selectors: {
    dimensions: DimensionSelectorState;
    metrics: MetricSelectorState;
    charts: ChartSelectorState;
  };
}
```

### 2.4 ä¸‰å¤§é€‰æ‹©å™¨ç»„ä»¶æŠ€æœ¯å®ç°

#### 2.4.1 ç»´åº¦é€‰æ‹©å™¨ (DimensionPicker)

**ç»„ä»¶æ¶æ„**:
```typescript
// ç»´åº¦é€‰æ‹©å™¨çŠ¶æ€æ¥å£
interface DimensionSelectorState {
  selectedDimensions: string[];  // å·²é€‰ç»´åº¦åˆ—è¡¨
  dimensionOrder: string[];      // ç»´åº¦æ’åºï¼ˆå½±å“åˆ†ç»„ä¼˜å…ˆçº§ï¼‰
  cascadeSelections: Record<string, string[]>;  // çº§è”é€‰æ‹©çŠ¶æ€
  quickTemplates: DimensionTemplate[];  // å¿«æ·æ¨¡æ¿
  recentCombinations: string[][];  // æœ€è¿‘ä½¿ç”¨çš„ç»´åº¦ç»„åˆ
}

// ç»´åº¦é€‰æ‹©å™¨ç»„ä»¶
class DimensionPicker extends React.Component {
  // å¤„ç†å¤šé€‰é€»è¾‘
  handleMultiSelect = (dimension: string) => {
    // æ›´æ–°é€‰ä¸­çŠ¶æ€ï¼Œæ”¯æŒæ’åº
  };
  
  // å¤„ç†çº§è”é€‰æ‹©
  handleCascadeSelect = (parentDimension: string, childDimension: string) => {
    // chengdu_branch â†’ third_level_organization çº§è”é€»è¾‘
  };
  
  // åº”ç”¨å¿«æ·æ¨¡æ¿
  applyTemplate = (template: DimensionTemplate) => {
    // åº”ç”¨é¢„è®¾çš„ç»´åº¦ç»„åˆ
  };
}
```

**æ ¸å¿ƒç‰¹æ€§å®ç°**:
- **æ‹–æ‹½æ’åº**: ä½¿ç”¨ `react-beautiful-dnd` å®ç°ç»´åº¦æ’åº
- **çº§è”é€‰æ‹©**: åŸºäºæ•°æ®å­—å…¸å®ç° `chengdu_branch â†’ third_level_organization` è”åŠ¨
- **å¿«æ·æ¨¡æ¿**: é¢„è®¾å¸¸ç”¨ç»´åº¦ç»„åˆï¼Œæ”¯æŒä¸€é”®åº”ç”¨
- **å†å²è®°å½•**: æœ¬åœ°å­˜å‚¨æœ€è¿‘ä½¿ç”¨çš„TOP5ç»´åº¦ç»„åˆ

#### 2.4.2 æŒ‡æ ‡é€‰æ‹©å™¨ (MetricPicker)

**ç»„ä»¶æ¶æ„**:
```typescript
// æŒ‡æ ‡é€‰æ‹©å™¨çŠ¶æ€æ¥å£
interface MetricSelectorState {
  selectedMetrics: string[];     // å·²é€‰æŒ‡æ ‡
  metricConfigs: MetricConfig[]; // æŒ‡æ ‡é…ç½®ï¼ˆå•ä½ã€ç²¾åº¦ç­‰ï¼‰
  derivedMetrics: DerivedMetric[]; // è¡ç”ŸæŒ‡æ ‡å®šä¹‰
  favoriteCollections: MetricCollection[]; // æ”¶è—çš„æŒ‡æ ‡é›†åˆ
  comparisonSettings: ComparisonConfig; // åŒæ¯”/ç¯æ¯”è®¾ç½®
}

// æŒ‡æ ‡é…ç½®æ¥å£
interface MetricConfig {
  metricId: string;
  unit: 'yuan' | 'percent' | 'count' | 'ratio';
  precision: number;  // å°æ•°ä½æ•°
  showComparison: boolean;  // æ˜¯å¦æ˜¾ç¤ºåŒæ¯”/ç¯æ¯”
  comparisonType: 'YoY' | 'WoW' | 'MoM';
}

// æŒ‡æ ‡é€‰æ‹©å™¨ç»„ä»¶
class MetricPicker extends React.Component {
  // å¤„ç†æŒ‡æ ‡é€‰æ‹©
  handleMetricSelect = (metricId: string) => {
    // æ›´æ–°é€‰ä¸­çŠ¶æ€ï¼Œå¤„ç†åŸå­æŒ‡æ ‡å’Œè¡ç”ŸæŒ‡æ ‡
  };
  
  // é…ç½®æŒ‡æ ‡æ˜¾ç¤º
  configureMetric = (metricId: string, config: MetricConfig) => {
    // è®¾ç½®å•ä½ã€ç²¾åº¦ã€åŒæ¯”ç¯æ¯”ç­‰
  };
  
  // ç®¡ç†æ”¶è—é›†åˆ
  manageCollection = (collection: MetricCollection) => {
    // "ç»è¥ä¸‰æ¿æ–§" = [æ»¡æœŸä¿è´¹, æŸå¤±ç‡, ç»¼åˆæˆæœ¬ç‡]
  };
}
```

**æ ¸å¿ƒç‰¹æ€§å®ç°**:
- **åŠ¨æ€å•ä½è½¬æ¢**: æ”¯æŒä¸‡å…ƒã€ç™¾åˆ†æ¯”ã€æ¬¡æ•°ç­‰å•ä½åˆ‡æ¢
- **ç²¾åº¦æ§åˆ¶**: å¯é…ç½®å°æ•°ä½æ•°ï¼Œå®æ—¶é¢„è§ˆæ•ˆæœ
- **åŒæ¯”ç¯æ¯”**: è‡ªåŠ¨ç”Ÿæˆ Î”% æ›²çº¿ï¼Œæ”¯æŒYoY/WoW/MoMåˆ‡æ¢
- **æ”¶è—é›†åˆ**: æ”¯æŒåˆ›å»ºå’Œç®¡ç†å¸¸ç”¨æŒ‡æ ‡ç»„åˆ

#### 2.4.3 å¤šç»´åº¦ç­›é€‰ç³»ç»Ÿ (MultiDimensionFilter)

**ç»„ä»¶æ¶æ„**:
```typescript
// å¤šç»´åº¦ç­›é€‰å™¨çŠ¶æ€æ¥å£
interface FilterState {
  activeFilters: Record<string, FilterValue[]>; // å½“å‰æ¿€æ´»çš„ç­›é€‰æ¡ä»¶
  availableDimensions: DimensionConfig[];       // å¯ç”¨ç­›é€‰ç»´åº¦
  filterHistory: FilterSnapshot[];             // ç­›é€‰å†å²è®°å½•
  quickFilters: QuickFilterTemplate[];         // å¿«æ·ç­›é€‰æ¨¡æ¿
}

// ç­›é€‰ç»´åº¦é…ç½®
interface DimensionConfig {
  key: string;           // å­—æ®µå
  label: string;         // æ˜¾ç¤ºåç§°
  type: 'select' | 'multiSelect' | 'dateRange' | 'boolean';
  options?: FilterOption[]; // å¯é€‰å€¼åˆ—è¡¨
  defaultValue?: any;    // é»˜è®¤å€¼
  dependencies?: string[]; // ä¾èµ–çš„å…¶ä»–ç»´åº¦
}

// 16ä¸ªæ ¸å¿ƒç­›é€‰ç»´åº¦å®šä¹‰
const FILTER_DIMENSIONS: DimensionConfig[] = [
  { key: 'week_number', label: 'å‘¨åºå·', type: 'select' },
  { key: 'policy_start_year', label: 'ä¿å•å¹´åº¦', type: 'select' },
  { key: 'business_type_category', label: 'ä¸šåŠ¡ç±»å‹', type: 'multiSelect' },
  { key: 'chengdu_branch', label: 'æœºæ„åœ°åŸŸå±æ€§', type: 'select' },
  { key: 'third_level_organization', label: 'ä¸‰çº§æœºæ„', type: 'multiSelect' },
  { key: 'customer_category_3', label: 'å®¢æˆ·ç±»åˆ«', type: 'multiSelect' },
  { key: 'insurance_type', label: 'è½¦é™©ç§ç±»', type: 'multiSelect' },
  { key: 'is_new_energy_vehicle', label: 'æ˜¯å¦æ–°èƒ½æºè½¦', type: 'boolean' },
  { key: 'coverage_type', label: 'æŠ•ä¿é™©åˆ«ç»„åˆ', type: 'multiSelect' },
  { key: 'is_transferred_vehicle', label: 'æ˜¯å¦è¿‡æˆ·è½¦è¾†', type: 'boolean' },
  { key: 'renewal_status', label: 'ç»­ä¿çŠ¶æ€', type: 'multiSelect' },
  { key: 'vehicle_insurance_grade', label: 'éè¥ä¸šå®¢è½¦é£é™©è¯„çº§', type: 'multiSelect' },
  { key: 'highway_risk_grade', label: 'é«˜é€Ÿè¡Œé©¶é£é™©è¯„çº§', type: 'multiSelect' },
  { key: 'large_truck_score', label: 'è´§è½¦é£é™©è¯„çº§', type: 'multiSelect' },
  { key: 'small_truck_score', label: 'å°è´§è½¦é£é™©è¯„çº§', type: 'multiSelect' },
  { key: 'terminal_source', label: 'æŠ•ä¿ç»ˆç«¯æ¥æº', type: 'multiSelect' }
];

// å¤šç»´åº¦ç­›é€‰å™¨ç»„ä»¶
class MultiDimensionFilter extends React.Component {
  // åº”ç”¨ç­›é€‰æ¡ä»¶
  applyFilters = (filters: Record<string, FilterValue[]>) => {
    // éªŒè¯ç­›é€‰æ¡ä»¶çš„æœ‰æ•ˆæ€§
    // æ›´æ–°å…¨å±€çŠ¶æ€
    // è§¦å‘æ•°æ®é‡æ–°åŠ è½½
  };
  
  // é‡ç½®ç­›é€‰æ¡ä»¶
  resetFilters = () => {
    // æ¢å¤åˆ°é»˜è®¤ç­›é€‰çŠ¶æ€
  };
  
  // ä¿å­˜å¿«æ·ç­›é€‰æ¨¡æ¿
  saveQuickFilter = (name: string, filters: Record<string, FilterValue[]>) => {
    // ä¿å­˜å¸¸ç”¨ç­›é€‰ç»„åˆä¸ºæ¨¡æ¿
  };
}
```

**æ ¸å¿ƒç‰¹æ€§å®ç°**:
- **å¼¹çª—äº¤äº’**: ç‚¹å‡»"ç­›é€‰å™¨"æŒ‰é’®è§¦å‘æ¨¡æ€æ¡†ï¼Œæ”¯æŒå¤šç»´åº¦åŒæ—¶ç­›é€‰
- **çº§è”ç­›é€‰**: æ”¯æŒç»´åº¦é—´çš„ä¾èµ–å…³ç³»ï¼Œå¦‚é€‰æ‹©æœºæ„åè‡ªåŠ¨æ›´æ–°ä¸‹çº§é€‰é¡¹
- **å¿«æ·æ¨¡æ¿**: é¢„è®¾å¸¸ç”¨ç­›é€‰ç»„åˆï¼Œå¦‚"æˆéƒ½æœ¬éƒ¨+å•†ä¸šé™©+æœ¬å‘¨"ç­‰
- **ç­›é€‰å†å²**: è®°å½•æœ€è¿‘ä½¿ç”¨çš„ç­›é€‰æ¡ä»¶ï¼Œæ”¯æŒå¿«é€Ÿå›é€€
- **æ•°æ®éªŒè¯**: ç¡®ä¿ç­›é€‰æ¡ä»¶çš„æœ‰æ•ˆæ€§ï¼Œé˜²æ­¢æ— æ•ˆæŸ¥è¯¢

#### 2.4.4 å›¾è¡¨ç±»å‹é€‰æ‹©å™¨ (ChartPicker)

**ç»„ä»¶æ¶æ„**:
```typescript
// å›¾è¡¨é€‰æ‹©å™¨çŠ¶æ€æ¥å£
interface ChartSelectorState {
  selectedChartType: ChartType;
  fieldMappings: FieldMapping;   // å­—æ®µæ˜ å°„å…³ç³»
  chartPreferences: ChartPreferences; // å›¾è¡¨åå¥½è®¾ç½®
  availableCharts: ChartOption[]; // å¯ç”¨å›¾è¡¨ç±»å‹
}

// å­—æ®µæ˜ å°„æ¥å£
interface FieldMapping {
  x: string;      // Xè½´å­—æ®µ
  y: string[];    // Yè½´å­—æ®µï¼ˆæ”¯æŒå¤šä¸ªï¼‰
  color?: string; // é¢œè‰²å­—æ®µ
  size?: string;  // å¤§å°å­—æ®µï¼ˆæ°”æ³¡å›¾ï¼‰
  facet?: string; // åˆ†é¢å­—æ®µ
}

// å›¾è¡¨é€‰æ‹©å™¨ç»„ä»¶
class ChartPicker extends React.Component {
  // æ™ºèƒ½æ¨èå›¾è¡¨ç±»å‹
  recommendChartType = (dimensions: string[], metrics: string[]) => {
    // åŸºäºç»´åº¦å’ŒæŒ‡æ ‡ç‰¹å¾æ¨èåˆé€‚çš„å›¾è¡¨ç±»å‹
    // æ—¶é—´ç»´åº¦ â†’ æŠ˜çº¿å›¾/é¢ç§¯å›¾
    // åˆ†ç±»ç»´åº¦ â†’ ç‚¹å›¾/çƒ­åŠ›å›¾
    // å±‚çº§æ•°æ® â†’ çŸ©å½¢æ ‘å›¾
  };
  
  // å¤„ç†å›¾è¡¨ç±»å‹åˆ‡æ¢
  handleChartTypeChange = (newType: ChartType) => {
    // åˆ‡æ¢å›¾è¡¨ç±»å‹ï¼Œä¿æŒå­—æ®µæ˜ å°„å…³ç³»
  };
  
  // é…ç½®å­—æ®µæ˜ å°„
  configureFieldMapping = (mapping: FieldMapping) => {
    // è®¾ç½®X/Y/Color/Sizeå­—æ®µæ˜ å°„
  };
}
```

**æ ¸å¿ƒç‰¹æ€§å®ç°**:
- **æ™ºèƒ½æ¨è**: åŸºäºæ•°æ®ç‰¹å¾è‡ªåŠ¨æ¨èæœ€é€‚åˆçš„å›¾è¡¨ç±»å‹
- **å­—æ®µæ˜ å°„ä¿æŒ**: åˆ‡æ¢å›¾è¡¨ç±»å‹æ—¶å°½é‡ä¿æŒå·²é…ç½®çš„å­—æ®µæ˜ å°„
- **åå¥½è®°å¿†**: è®°ä½ç”¨æˆ·çš„å›¾è¡¨ç±»å‹åå¥½ï¼Œä¼˜å…ˆæ¨è
- **å®æ—¶é¢„è§ˆ**: æä¾›å›¾è¡¨ç±»å‹çš„ç¼©ç•¥å›¾é¢„è§ˆ

#### 2.4.5 æ ¸å¿ƒæŒ‡æ ‡çœ‹æ¿ç³»ç»Ÿ (KPIDashboard)

**ç»„ä»¶æ¶æ„**:
```typescript
// KPIçœ‹æ¿çŠ¶æ€æ¥å£
interface KPIDashboardState {
  kpiData: KPIMetric[];           // 16ä¸ªæ ¸å¿ƒKPIæ•°æ®
  currentWeek: number;            // å½“å‰é€‰æ‹©çš„å‘¨
  previousWeek: number;           // å¯¹æ¯”å‘¨ï¼ˆå‰ä¸€å‘¨ï¼‰
  gridLayout: GridLayout;         // 4x4ç½‘æ ¼å¸ƒå±€é…ç½®
  loadingStates: Record<string, boolean>; // å„æŒ‡æ ‡åŠ è½½çŠ¶æ€
}

// KPIæŒ‡æ ‡æ•°æ®ç»“æ„
interface KPIMetric {
  id: string;                     // æŒ‡æ ‡ID
  name: string;                   // æŒ‡æ ‡åç§°
  currentValue: number;           // å½“å‰å€¼
  previousValue: number;          // å¯¹æ¯”å€¼ï¼ˆå‰ä¸€å‘¨ï¼‰
  unit: string;                   // å•ä½
  precision: number;              // å°æ•°ä½æ•°
  changeAbsolute: number;         // ç»å¯¹å˜åŒ–å€¼
  changePercentage: number;       // ç™¾åˆ†æ¯”å˜åŒ–
  trend: 'up' | 'down' | 'stable'; // è¶‹åŠ¿æ–¹å‘
  status: 'good' | 'warning' | 'danger'; // çŠ¶æ€è¯„çº§
}

// 16ä¸ªæ ¸å¿ƒKPIæŒ‡æ ‡å®šä¹‰
const CORE_KPI_METRICS: KPIMetricConfig[] = [
  { id: 'margin_contribution_rate', name: 'è¾¹é™…è´¡çŒ®ç‡', unit: '%', precision: 2, position: [0, 0] },
  { id: 'follow_up_premium', name: 'è·Ÿå•ä¿è´¹', unit: 'ä¸‡å…ƒ', precision: 2, position: [0, 1] },
  { id: 'premium_time_progress_rate', name: 'ä¿è´¹æ—¶é—´è¿›åº¦è¾¾æˆç‡', unit: '%', precision: 2, position: [0, 2] },
  { id: 'variable_cost_rate', name: 'å˜åŠ¨æˆæœ¬ç‡', unit: '%', precision: 2, position: [0, 3] },
  { id: 'margin_contribution_amount', name: 'è¾¹è´¡é¢', unit: 'ä¸‡å…ƒ', precision: 2, position: [1, 0] },
  { id: 'matured_premium', name: 'æ»¡æœŸä¿è´¹', unit: 'ä¸‡å…ƒ', precision: 2, position: [1, 1] },
  { id: 'total_claims', name: 'æ€»èµ”æ¬¾', unit: 'ä¸‡å…ƒ', precision: 2, position: [1, 2] },
  { id: 'expense_amount', name: 'è´¹ç”¨é¢', unit: 'ä¸‡å…ƒ', precision: 2, position: [1, 3] },
  { id: 'premium_maturity_rate', name: 'ä¿è´¹æ»¡æœŸç‡', unit: '%', precision: 2, position: [2, 0] },
  { id: 'policy_count', name: 'ä¿å•ä»¶æ•°', unit: 'ä»¶', precision: 0, position: [2, 1] },
  { id: 'matured_loss_ratio', name: 'æ»¡æœŸèµ”ä»˜ç‡', unit: '%', precision: 2, position: [2, 2] },
  { id: 'expense_ratio', name: 'è´¹ç”¨ç‡', unit: '%', precision: 2, position: [2, 3] },
  { id: 'average_premium', name: 'å•å‡ä¿è´¹', unit: 'å…ƒ', precision: 2, position: [3, 0] },
  { id: 'reported_claims_count', name: 'å·²æŠ¥ä»¶æ•°', unit: 'ä»¶', precision: 0, position: [3, 1] },
  { id: 'average_claim_amount', name: 'æ¡ˆå‡èµ”æ¬¾', unit: 'å…ƒ', precision: 2, position: [3, 2] },
  { id: 'matured_claim_frequency', name: 'æ»¡æœŸå‡ºé™©ç‡', unit: '%', precision: 2, position: [3, 3] }
];

// KPIçœ‹æ¿ç»„ä»¶
class KPIDashboard extends React.Component {
  // åŠ è½½KPIæ•°æ®
  loadKPIData = async (week: number, filters: FilterState) => {
    // åŸºäºç­›é€‰æ¡ä»¶å’Œé€‰å®šå‘¨åŠ è½½16ä¸ªKPIæŒ‡æ ‡æ•°æ®
    // åŒæ—¶åŠ è½½å‰ä¸€å‘¨æ•°æ®ç”¨äºå¯¹æ¯”
  };
  
  // è®¡ç®—å‘¨ç¯æ¯”
  calculateWeekOverWeek = (current: number, previous: number) => {
    const changeAbsolute = current - previous;
    const changePercentage = previous !== 0 ? (changeAbsolute / previous) * 100 : 0;
    return { changeAbsolute, changePercentage };
  };
  
  // æ¸²æŸ“KPIå¡ç‰‡
  renderKPICard = (metric: KPIMetric) => {
    // æ¸²æŸ“å•ä¸ªKPIæŒ‡æ ‡å¡ç‰‡
    // åŒ…å«æŒ‡æ ‡åç§°ã€å½“å‰å€¼ã€å˜åŒ–å€¼å’Œç™¾åˆ†æ¯”
  };
  
  // å¤„ç†æŒ‡æ ‡ç‚¹å‡»äº‹ä»¶
  handleKPIClick = (metricId: string) => {
    // ç‚¹å‡»KPIå¡ç‰‡æ—¶çš„äº¤äº’é€»è¾‘
    // å¯èƒ½è§¦å‘è¯¦ç»†åˆ†ææˆ–é’»å–
  };
}
```

**æ ¸å¿ƒç‰¹æ€§å®ç°**:
- **4x4ç½‘æ ¼å¸ƒå±€**: å›ºå®š16ä¸ªKPIæŒ‡æ ‡çš„ç½‘æ ¼ä½ç½®ï¼Œç¡®ä¿å¸ƒå±€ä¸€è‡´æ€§
- **å‘¨ç¯æ¯”å¯¹æ¯”**: è‡ªåŠ¨è®¡ç®—å½“å‰å‘¨ä¸å‰ä¸€å‘¨çš„å·®å¼‚ï¼Œæ˜¾ç¤ºç»å¯¹å€¼å’Œç™¾åˆ†æ¯”å˜åŒ–
- **å®æ—¶æ•°æ®æ›´æ–°**: åŸºäºç­›é€‰æ¡ä»¶å˜åŒ–å®æ—¶é‡æ–°è®¡ç®—KPIæ•°æ®
- **çŠ¶æ€æŒ‡ç¤º**: é€šè¿‡é¢œè‰²å’Œå›¾æ ‡æ˜¾ç¤ºæŒ‡æ ‡çš„è¶‹åŠ¿å’Œå¥åº·çŠ¶æ€
- **ç²¾åº¦æ§åˆ¶**: æ ¹æ®æŒ‡æ ‡ç±»å‹è‡ªåŠ¨è®¾ç½®åˆé€‚çš„å°æ•°ä½æ•°
- **å•ä½è½¬æ¢**: æ”¯æŒä¸‡å…ƒã€ç™¾åˆ†æ¯”ã€ä»¶æ•°ç­‰ä¸åŒå•ä½çš„æ˜¾ç¤º

#### 2.4.6 é€‰æ‹©å™¨é—´åè°ƒæœºåˆ¶

**çŠ¶æ€åŒæ­¥**:
```typescript
// é€‰æ‹©å™¨åè°ƒå™¨
class SelectorCoordinator {
  // ç»´åº¦å˜æ›´æ—¶æ›´æ–°å¯ç”¨æŒ‡æ ‡
  onDimensionChange = (dimensions: string[]) => {
    const availableMetrics = this.getCompatibleMetrics(dimensions);
    this.updateMetricSelector(availableMetrics);
  };
  
  // æŒ‡æ ‡å˜æ›´æ—¶æ¨èå›¾è¡¨ç±»å‹
  onMetricChange = (metrics: string[]) => {
    const recommendedCharts = this.recommendCharts(this.currentDimensions, metrics);
    this.updateChartSelector(recommendedCharts);
  };
  
  // å›¾è¡¨ç±»å‹å˜æ›´æ—¶éªŒè¯å­—æ®µæ˜ å°„
  onChartTypeChange = (chartType: ChartType) => {
    const validMappings = this.validateFieldMappings(chartType);
    this.updateFieldMappings(validMappings);
  };
}
```

**æ€§èƒ½ä¼˜åŒ–**:
- **é˜²æŠ–å¤„ç†**: ç”¨æˆ·å¿«é€Ÿæ“ä½œæ—¶é¿å…é¢‘ç¹é‡æ–°è®¡ç®—
- **å¢é‡æ›´æ–°**: åªæ›´æ–°å˜åŒ–çš„éƒ¨åˆ†ï¼Œé¿å…å…¨é‡é‡æ¸²æŸ“
- **è™šæ‹Ÿæ»šåŠ¨**: å¤§é‡é€‰é¡¹æ—¶ä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨æå‡æ€§èƒ½
- **é¢„åŠ è½½**: é¢„åŠ è½½å¸¸ç”¨çš„ç»´åº¦å’ŒæŒ‡æ ‡ç»„åˆ

#### 2.4.7 AIæ™ºèƒ½æ´å¯Ÿç³»ç»Ÿ (AIInsightEngine)

**ç»„ä»¶æ¶æ„**:
```typescript
// AIæ´å¯Ÿå¼•æ“çŠ¶æ€æ¥å£
interface AIInsightState {
  analysisResults: InsightReport[];     // åˆ†ææŠ¥å‘Šåˆ—è¡¨
  currentAnalysis: InsightReport | null; // å½“å‰åˆ†æç»“æœ
  analysisHistory: InsightReport[];     // å†å²åˆ†æè®°å½•
  isAnalyzing: boolean;                 // åˆ†æè¿›è¡ŒçŠ¶æ€
  analysisProgress: number;             // åˆ†æè¿›åº¦
}

// æ´å¯ŸæŠ¥å‘Šæ•°æ®ç»“æ„
interface InsightReport {
  id: string;                          // æŠ¥å‘ŠID
  timestamp: Date;                     // ç”Ÿæˆæ—¶é—´
  analysisType: 'cost_trend';          // åˆ†æç±»å‹
  inputData: KPIMetric[];              // è¾“å…¥çš„KPIæ•°æ®
  filterContext: FilterState;          // ç­›é€‰ä¸Šä¸‹æ–‡
  insights: {
    trendAnalysis: string;             // è¶‹åŠ¿åˆ†ææ®µè½
    anomalyDetection: string;          // å¼‚å¸¸è¯†åˆ«æ®µè½
    businessRecommendations: string;   // ä¸šåŠ¡æ´å¯Ÿæ®µè½
  };
  confidence: number;                  // åˆ†æç½®ä¿¡åº¦
  dataQuality: 'high' | 'medium' | 'low'; // æ•°æ®è´¨é‡è¯„ä¼°
}

// AIåˆ†æå¼•æ“é…ç½®
interface AIAnalysisConfig {
  analysisPrompt: string;              // åˆ†ææç¤ºè¯æ¨¡æ¿
  contextWindow: number;               // ä¸Šä¸‹æ–‡çª—å£å¤§å°
  temperature: number;                 // ç”Ÿæˆæ¸©åº¦å‚æ•°
  maxTokens: number;                   // æœ€å¤§tokenæ•°
  retryAttempts: number;               // é‡è¯•æ¬¡æ•°
}

// AIæ™ºèƒ½æ´å¯Ÿç»„ä»¶
class AIInsightEngine extends React.Component {
  // è§¦å‘æˆæœ¬è¶‹åŠ¿åˆ†æ
  analyzeCostTrend = async (kpiData: KPIMetric[], filterContext: FilterState) => {
    this.setState({ isAnalyzing: true, analysisProgress: 0 });
    
    try {
      // 1. æ•°æ®é¢„å¤„ç†å’Œç‰¹å¾æå–
      const features = this.extractFeatures(kpiData);
      this.setState({ analysisProgress: 30 });
      
      // 2. æ„å»ºåˆ†æä¸Šä¸‹æ–‡
      const analysisContext = this.buildAnalysisContext(features, filterContext);
      this.setState({ analysisProgress: 50 });
      
      // 3. è°ƒç”¨AIåˆ†ææœåŠ¡
      const insights = await this.callAIAnalysisService(analysisContext);
      this.setState({ analysisProgress: 80 });
      
      // 4. ç”Ÿæˆç»“æ„åŒ–æŠ¥å‘Š
      const report = this.generateInsightReport(insights, kpiData, filterContext);
      this.setState({ analysisProgress: 100 });
      
      // 5. æ›´æ–°çŠ¶æ€å’Œå†å²è®°å½•
      this.updateAnalysisResults(report);
      
    } catch (error) {
      this.handleAnalysisError(error);
    } finally {
      this.setState({ isAnalyzing: false });
    }
  };
  
  // æå–æ•°æ®ç‰¹å¾
  extractFeatures = (kpiData: KPIMetric[]) => {
    return {
      // æˆæœ¬ç›¸å…³æŒ‡æ ‡
      costMetrics: kpiData.filter(m => ['variable_cost_rate', 'expense_ratio', 'total_claims'].includes(m.id)),
      // æ”¶å…¥ç›¸å…³æŒ‡æ ‡
      revenueMetrics: kpiData.filter(m => ['follow_up_premium', 'matured_premium'].includes(m.id)),
      // æ•ˆç‡ç›¸å…³æŒ‡æ ‡
      efficiencyMetrics: kpiData.filter(m => ['margin_contribution_rate', 'premium_time_progress_rate'].includes(m.id)),
      // å˜åŒ–è¶‹åŠ¿
      trends: kpiData.map(m => ({ id: m.id, change: m.changePercentage, trend: m.trend })),
      // å¼‚å¸¸æŒ‡æ ‡
      anomalies: kpiData.filter(m => Math.abs(m.changePercentage) > 10)
    };
  };
  
  // æ„å»ºåˆ†æä¸Šä¸‹æ–‡
  buildAnalysisContext = (features: any, filterContext: FilterState) => {
    return {
      timeContext: `åˆ†æå‘¨æœŸï¼šç¬¬${filterContext.week_number}å‘¨`,
      businessContext: this.getBusinessContext(filterContext),
      dataFeatures: features,
      analysisGoal: 'è¯†åˆ«æˆæœ¬å˜åŒ–è¶‹åŠ¿ï¼Œå‘ç°å¼‚å¸¸ç‚¹ï¼Œæä¾›ä¸šåŠ¡ä¼˜åŒ–å»ºè®®'
    };
  };
  
  // è°ƒç”¨AIåˆ†ææœåŠ¡
  callAIAnalysisService = async (context: any) => {
    const prompt = this.buildAnalysisPrompt(context);
    
    const response = await fetch('/api/v1/ai/analyze', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        prompt,
        config: this.getAIConfig()
      })
    });
    
    return await response.json();
  };
  
  // æ„å»ºåˆ†ææç¤ºè¯
  buildAnalysisPrompt = (context: any) => {
    return `
ä½œä¸ºè½¦é™©ä¸šåŠ¡åˆ†æä¸“å®¶ï¼Œè¯·åŸºäºä»¥ä¸‹KPIæ•°æ®è¿›è¡Œæ·±åº¦åˆ†æï¼š

${JSON.stringify(context, null, 2)}

è¯·æŒ‰ä»¥ä¸‹ç»“æ„ç”Ÿæˆåˆ†ææŠ¥å‘Šï¼š

1. è¶‹åŠ¿åˆ†æï¼ˆ150-200å­—ï¼‰ï¼š
   - è§£è¯»æ ¸å¿ƒæˆæœ¬æŒ‡æ ‡çš„å˜åŒ–è¶‹åŠ¿
   - åˆ†æå˜åŒ–èƒŒåçš„å¯èƒ½åŸå› 
   - è¯†åˆ«å…³é”®é©±åŠ¨å› ç´ 

2. å¼‚å¸¸è¯†åˆ«ï¼ˆ100-150å­—ï¼‰ï¼š
   - è¯†åˆ«æ•°æ®ä¸­çš„æ˜¾è‘—å¼‚å¸¸ç‚¹
   - åˆ†æå¼‚å¸¸çš„å¯èƒ½åŸå› 
   - è¯„ä¼°å¼‚å¸¸çš„ä¸šåŠ¡å½±å“

3. ä¸šåŠ¡æ´å¯Ÿï¼ˆ150-200å­—ï¼‰ï¼š
   - æä¾›2-3ä¸ªå…·ä½“ã€å¯æ‰§è¡Œçš„ä¼˜åŒ–å»ºè®®
   - å»ºè®®åº”åŸºäºæ•°æ®æ´å¯Ÿä¸”å…·æœ‰å®æ“æ€§
   - é¢„ä¼°å»ºè®®å®æ–½åçš„é¢„æœŸæ•ˆæœ

è¦æ±‚ï¼š
- ä½¿ç”¨ä¸“ä¸šä½†æ˜“æ‡‚çš„ä¸­æ–‡è¡¨è¾¾
- ç»“åˆè½¦é™©è¡Œä¸šç‰¹ç‚¹å’Œä¸šåŠ¡é€»è¾‘
- é¿å…è¿‡äºæŠ€æœ¯åŒ–çš„æœ¯è¯­
- ç¡®ä¿å»ºè®®çš„å¯æ“ä½œæ€§
    `;
  };
  
  // ç”Ÿæˆæ´å¯ŸæŠ¥å‘Š
  generateInsightReport = (insights: any, kpiData: KPIMetric[], filterContext: FilterState): InsightReport => {
    return {
      id: `insight_${Date.now()}`,
      timestamp: new Date(),
      analysisType: 'cost_trend',
      inputData: kpiData,
      filterContext,
      insights: {
        trendAnalysis: insights.trendAnalysis,
        anomalyDetection: insights.anomalyDetection,
        businessRecommendations: insights.businessRecommendations
      },
      confidence: insights.confidence || 0.85,
      dataQuality: this.assessDataQuality(kpiData)
    };
  };
  
  // è¯„ä¼°æ•°æ®è´¨é‡
  assessDataQuality = (kpiData: KPIMetric[]) => {
    const completeness = kpiData.filter(m => m.currentValue !== null).length / kpiData.length;
    const consistency = kpiData.filter(m => !isNaN(m.changePercentage)).length / kpiData.length;
    
    if (completeness > 0.9 && consistency > 0.9) return 'high';
    if (completeness > 0.7 && consistency > 0.7) return 'medium';
    return 'low';
  };
}
```

**æ ¸å¿ƒç‰¹æ€§å®ç°**:
- **ä¸‰æ®µå¼åˆ†æ**: è‡ªåŠ¨ç”Ÿæˆè¶‹åŠ¿åˆ†æã€å¼‚å¸¸è¯†åˆ«ã€ä¸šåŠ¡æ´å¯Ÿä¸‰ä¸ªç»´åº¦çš„æŠ¥å‘Š
- **ä¸Šä¸‹æ–‡æ„ŸçŸ¥**: åŸºäºå½“å‰ç­›é€‰æ¡ä»¶å’ŒKPIæ•°æ®æä¾›é’ˆå¯¹æ€§åˆ†æ
- **è¿›åº¦åé¦ˆ**: å®æ—¶æ˜¾ç¤ºAIåˆ†æè¿›åº¦ï¼Œæå‡ç”¨æˆ·ä½“éªŒ
- **å†å²è®°å½•**: ä¿å­˜åˆ†æå†å²ï¼Œæ”¯æŒå¯¹æ¯”å’Œå›é¡¾
- **æ•°æ®è´¨é‡è¯„ä¼°**: è‡ªåŠ¨è¯„ä¼°è¾“å…¥æ•°æ®è´¨é‡ï¼Œå½±å“åˆ†æç½®ä¿¡åº¦
- **é”™è¯¯å¤„ç†**: å®Œå–„çš„é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶

#### 2.4.8 æ•°æ®å¯¼å…¥ç³»ç»Ÿ (DataImportSystem)

**ç»„ä»¶æ¶æ„**:
```typescript
// æ•°æ®å¯¼å…¥çŠ¶æ€æ¥å£
interface DataImportState {
  uploadProgress: number;              // ä¸Šä¼ è¿›åº¦
  validationResults: ValidationResult[]; // éªŒè¯ç»“æœ
  importHistory: ImportRecord[];       // å¯¼å…¥å†å²
  isUploading: boolean;               // ä¸Šä¼ çŠ¶æ€
  isValidating: boolean;              // éªŒè¯çŠ¶æ€
  currentFile: File | null;           // å½“å‰æ–‡ä»¶
}

// å¯¼å…¥è®°å½•æ•°æ®ç»“æ„
interface ImportRecord {
  id: string;                         // å¯¼å…¥ID
  timestamp: Date;                    // å¯¼å…¥æ—¶é—´
  fileName: string;                   // æ–‡ä»¶å
  filePath: string;                   // å­˜å‚¨è·¯å¾„
  policyYear: number;                 // èµ·ä¿å¹´åº¦
  weekNumber: number;                 // å‘¨åºå·
  recordCount: number;                // è®°å½•æ•°é‡
  status: 'success' | 'failed' | 'partial'; // å¯¼å…¥çŠ¶æ€
  validationErrors: ValidationError[]; // éªŒè¯é”™è¯¯
  processingTime: number;             // å¤„ç†æ—¶é—´(ms)
}

// æ–‡ä»¶éªŒè¯ç»“æœ
interface ValidationResult {
  isValid: boolean;                   // æ˜¯å¦æœ‰æ•ˆ
  errors: ValidationError[];          // é”™è¯¯åˆ—è¡¨
  warnings: ValidationWarning[];      // è­¦å‘Šåˆ—è¡¨
  summary: {
    totalRows: number;                // æ€»è¡Œæ•°
    validRows: number;                // æœ‰æ•ˆè¡Œæ•°
    errorRows: number;                // é”™è¯¯è¡Œæ•°
    duplicateRows: number;            // é‡å¤è¡Œæ•°
  };
}

// æ•°æ®å¯¼å…¥ç»„ä»¶
class DataImportSystem extends React.Component {
  // å¤„ç†æ–‡ä»¶ä¸Šä¼ 
  handleFileUpload = async (file: File, policyYear: number, weekNumber: number) => {
    this.setState({ isUploading: true, uploadProgress: 0 });
    
    try {
      // 1. æ–‡ä»¶åŸºç¡€éªŒè¯
      this.validateFileBasics(file);
      this.setState({ uploadProgress: 10 });
      
      // 2. ä¸Šä¼ æ–‡ä»¶åˆ°ä¸´æ—¶ç›®å½•
      const tempPath = await this.uploadToTemp(file);
      this.setState({ uploadProgress: 30 });
      
      // 3. æ•°æ®æ ¼å¼éªŒè¯
      const validationResult = await this.validateFileContent(tempPath);
      this.setState({ uploadProgress: 60, isValidating: true });
      
      // 4. å¦‚æœéªŒè¯é€šè¿‡ï¼Œç§»åŠ¨åˆ°æ­£å¼ç›®å½•
      if (validationResult.isValid) {
        const finalPath = this.generateFinalPath(policyYear, weekNumber);
        await this.moveToFinalLocation(tempPath, finalPath);
        this.setState({ uploadProgress: 90 });
        
        // 5. æ›´æ–°æ•°æ®ç´¢å¼•
        await this.updateDataIndex(finalPath, policyYear, weekNumber);
        this.setState({ uploadProgress: 100 });
        
        // 6. è®°å½•å¯¼å…¥å†å²
        this.recordImportHistory(file, finalPath, policyYear, weekNumber, validationResult);
        
      } else {
        // éªŒè¯å¤±è´¥ï¼Œæ¸…ç†ä¸´æ—¶æ–‡ä»¶
        await this.cleanupTempFile(tempPath);
        throw new Error('æ–‡ä»¶éªŒè¯å¤±è´¥');
      }
      
    } catch (error) {
      this.handleImportError(error);
    } finally {
      this.setState({ isUploading: false, isValidating: false });
    }
  };
  
  // ç”Ÿæˆæœ€ç»ˆå­˜å‚¨è·¯å¾„
  generateFinalPath = (policyYear: number, weekNumber: number) => {
    return `data/${policyYear}å¹´ä¿å•/${policyYear}å¹´ä¿å•æˆªè‡³${weekNumber}å‘¨æ•°æ®.csv`;
  };
  
  // éªŒè¯æ–‡ä»¶åŸºç¡€ä¿¡æ¯
  validateFileBasics = (file: File) => {
    // æ£€æŸ¥æ–‡ä»¶ç±»å‹
    if (!file.name.endsWith('.csv')) {
      throw new Error('åªæ”¯æŒCSVæ ¼å¼æ–‡ä»¶');
    }
    
    // æ£€æŸ¥æ–‡ä»¶å¤§å°ï¼ˆé™åˆ¶100MBï¼‰
    if (file.size > 100 * 1024 * 1024) {
      throw new Error('æ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡100MB');
    }
  };
  
  // éªŒè¯æ–‡ä»¶å†…å®¹
  validateFileContent = async (filePath: string): Promise<ValidationResult> => {
    const response = await fetch('/api/v1/data/validate', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ filePath })
    });
    
    return await response.json();
  };
  
  // ä¸Šä¼ åˆ°ä¸´æ—¶ç›®å½•
  uploadToTemp = async (file: File): Promise<string> => {
    const formData = new FormData();
    formData.append('file', file);
    
    const response = await fetch('/api/v1/data/upload-temp', {
      method: 'POST',
      body: formData,
      onUploadProgress: (progressEvent) => {
        const progress = Math.round((progressEvent.loaded * 100) / progressEvent.total);
        this.setState({ uploadProgress: Math.min(progress * 0.3, 30) });
      }
    });
    
    const result = await response.json();
    return result.tempPath;
  };
  
  // ç§»åŠ¨åˆ°æœ€ç»ˆä½ç½®
  moveToFinalLocation = async (tempPath: string, finalPath: string) => {
    await fetch('/api/v1/data/move-final', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ tempPath, finalPath })
    });
  };
  
  // æ›´æ–°æ•°æ®ç´¢å¼•
  updateDataIndex = async (filePath: string, policyYear: number, weekNumber: number) => {
    await fetch('/api/v1/data/update-index', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ filePath, policyYear, weekNumber })
    });
  };
  
  // è®°å½•å¯¼å…¥å†å²
  recordImportHistory = (file: File, filePath: string, policyYear: number, weekNumber: number, validation: ValidationResult) => {
    const record: ImportRecord = {
      id: `import_${Date.now()}`,
      timestamp: new Date(),
      fileName: file.name,
      filePath,
      policyYear,
      weekNumber,
      recordCount: validation.summary.validRows,
      status: validation.isValid ? 'success' : 'partial',
      validationErrors: validation.errors,
      processingTime: Date.now() - this.importStartTime
    };
    
    this.setState(prevState => ({
      importHistory: [record, ...prevState.importHistory.slice(0, 9)] // ä¿ç•™æœ€è¿‘10æ¡è®°å½•
    }));
  };
  
  // è·å–å¯¼å…¥å†å²
  getImportHistory = () => {
    return this.state.importHistory;
  };
  
  // é‡æ–°å¯¼å…¥
  retryImport = async (record: ImportRecord) => {
    // åŸºäºå†å²è®°å½•é‡æ–°å°è¯•å¯¼å…¥
  };
}
```

**æ ¸å¿ƒç‰¹æ€§å®ç°**:
- **å¼¹çª—äº¤äº’**: ç‚¹å‡»"å¯¼å…¥æ•°æ®"æŒ‰é’®è§¦å‘ä¸Šä¼ å¯¹è¯æ¡†ï¼ŒæŒ‡å®šå¹´åº¦å’Œå‘¨æ¬¡
- **æ–‡ä»¶éªŒè¯**: å¤šå±‚æ¬¡éªŒè¯åŒ…æ‹¬æ ¼å¼ã€å¤§å°ã€å†…å®¹ç»“æ„å’Œæ•°æ®è´¨é‡
- **è¿›åº¦åé¦ˆ**: å®æ—¶æ˜¾ç¤ºä¸Šä¼ ã€éªŒè¯ã€å¤„ç†å„é˜¶æ®µè¿›åº¦
- **è·¯å¾„è§„èŒƒ**: ä¸¥æ ¼æŒ‰ç…§`/{å¹´ä»½}å¹´ä¿å•/{å¹´ä»½}å¹´ä¿å•æˆªè‡³{å‘¨æ¬¡}å‘¨æ•°æ®.csv`æ ¼å¼å­˜å‚¨
- **é”™è¯¯å¤„ç†**: è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯å’Œæ¢å¤å»ºè®®
- **å†å²è®°å½•**: ä¿å­˜å¯¼å…¥å†å²ï¼Œæ”¯æŒé‡æ–°å¯¼å…¥å’Œé—®é¢˜è¿½æº¯
- **æ•°æ®ç´¢å¼•**: è‡ªåŠ¨æ›´æ–°æ•°æ®ç´¢å¼•ï¼Œç¡®ä¿æ–°æ•°æ®ç«‹å³å¯ç”¨

## 3. åç«¯æ¶æ„è®¾è®¡

### 3.1 æœåŠ¡æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        APIè·¯ç”±å±‚                             â”‚
â”‚   /api/v1/aggregate â”‚ /api/v1/kpi â”‚ /api/v1/export         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                        ä¸­é—´ä»¶å±‚                              â”‚
â”‚  è®¤è¯ä¸­é—´ä»¶ â”‚ æ—¥å¿—ä¸­é—´ä»¶ â”‚ é”™è¯¯å¤„ç† â”‚ è¯·æ±‚é™æµ             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                        ä¸šåŠ¡æœåŠ¡å±‚                            â”‚
â”‚  èšåˆæœåŠ¡ â”‚ KPIè®¡ç®—æœåŠ¡ â”‚ å¯¼å‡ºæœåŠ¡ â”‚ ç¼“å­˜æœåŠ¡             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                        æ•°æ®è®¿é—®å±‚                            â”‚
â”‚  CSVè¯»å–å™¨ â”‚ æ•°æ®è§£æå™¨ â”‚ æ•°æ®éªŒè¯å™¨ â”‚ ç¼“å­˜ç®¡ç†å™¨         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                        å·¥å…·å±‚                                â”‚
â”‚  æ—¥å¿—å·¥å…· â”‚ é…ç½®ç®¡ç† â”‚ é”™è¯¯å¤„ç† â”‚ æ€§èƒ½ç›‘æ§               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 æ•°æ®å¤„ç†æ¶æ„

#### æ•°æ®åŠ è½½ç­–ç•¥
```typescript
// æ•°æ®åŠ è½½ç®¡ç†å™¨
class DataLoader {
  private cache: Map<string, any> = new Map();
  private loadingPromises: Map<string, Promise<any>> = new Map();
  
  // æŒ‰éœ€åŠ è½½æ•°æ®
  async loadData(timeRange: TimeRange): Promise<RawData[]> {
    const cacheKey = this.getCacheKey(timeRange);
    
    // æ£€æŸ¥ç¼“å­˜
    if (this.cache.has(cacheKey)) {
      return this.cache.get(cacheKey);
    }
    
    // æ£€æŸ¥æ˜¯å¦æ­£åœ¨åŠ è½½
    if (this.loadingPromises.has(cacheKey)) {
      return this.loadingPromises.get(cacheKey);
    }
    
    // å¼€å§‹åŠ è½½
    const loadPromise = this.doLoadData(timeRange);
    this.loadingPromises.set(cacheKey, loadPromise);
    
    try {
      const data = await loadPromise;
      this.cache.set(cacheKey, data);
      return data;
    } finally {
      this.loadingPromises.delete(cacheKey);
    }
  }
}
```

#### èšåˆè®¡ç®—å¼•æ“
```typescript
// èšåˆè®¡ç®—å¼•æ“
class AggregationEngine {
  // å¤šç»´åº¦èšåˆ
  aggregate(
    data: RawData[],
    dimensions: string[],
    metrics: string[]
  ): AggregatedData[] {
    // 1. æ•°æ®åˆ†ç»„
    const groups = this.groupByDimensions(data, dimensions);
    
    // 2. æŒ‡æ ‡è®¡ç®—
    return groups.map(group => {
      const result: any = {};
      
      // å¤åˆ¶ç»´åº¦å€¼
      dimensions.forEach(dim => {
        result[dim] = group.key[dim];
      });
      
      // è®¡ç®—æŒ‡æ ‡
      metrics.forEach(metric => {
        result[metric] = this.calculateMetric(group.records, metric);
      });
      
      return result;
    });
  }
}
```

## 4. æ•°æ®å­˜å‚¨æ¶æ„

### 4.1 æ–‡ä»¶ç»„ç»‡ç»“æ„

```
data/
â”œâ”€â”€ raw/                    # åŸå§‹CSVæ•°æ®
â”‚   â”œâ”€â”€ 2023/
â”‚   â”‚   â”œâ”€â”€ week_01.csv
â”‚   â”‚   â”œâ”€â”€ week_02.csv
â”‚   â”‚   â””â”€â”€ ...
â”‚   â””â”€â”€ 2024/
â”‚       â”œâ”€â”€ week_01.csv
â”‚       â””â”€â”€ ...
â”œâ”€â”€ processed/              # é¢„å¤„ç†æ•°æ®
â”‚   â”œâ”€â”€ aggregated/
â”‚   â”‚   â”œâ”€â”€ monthly_summary.json
â”‚   â”‚   â””â”€â”€ weekly_kpis.json
â”‚   â””â”€â”€ cache/
â”‚       â”œâ”€â”€ filter_cache.json
â”‚       â””â”€â”€ dimension_cache.json
â””â”€â”€ config/                 # é…ç½®æ–‡ä»¶
    â”œâ”€â”€ field_mapping.json
    â””â”€â”€ calculation_rules.json
```

### 4.2 ç¼“å­˜ç­–ç•¥

#### å¤šå±‚ç¼“å­˜æ¶æ„
```typescript
// ç¼“å­˜ç®¡ç†å™¨
class CacheManager {
  private memoryCache: Map<string, any> = new Map();
  private diskCache: DiskCache;
  private maxMemorySize: number = 100 * 1024 * 1024; // 100MB
  
  // L1ç¼“å­˜ï¼šå†…å­˜ç¼“å­˜ï¼ˆæœ€å¿«ï¼‰
  getFromMemory(key: string): any {
    return this.memoryCache.get(key);
  }
  
  // L2ç¼“å­˜ï¼šç£ç›˜ç¼“å­˜ï¼ˆä¸­ç­‰é€Ÿåº¦ï¼‰
  async getFromDisk(key: string): Promise<any> {
    return this.diskCache.get(key);
  }
  
  // L3ç¼“å­˜ï¼šé‡æ–°è®¡ç®—ï¼ˆæœ€æ…¢ï¼‰
  async computeAndCache(key: string, computeFn: () => any): Promise<any> {
    const result = await computeFn();
    
    // å†™å…¥å¤šå±‚ç¼“å­˜
    this.memoryCache.set(key, result);
    await this.diskCache.set(key, result);
    
    return result;
  }
}
```

## 5. æ€§èƒ½ä¼˜åŒ–æ¶æ„

### 5.1 å‰ç«¯æ€§èƒ½ä¼˜åŒ–

#### ä»£ç åˆ†å‰²ç­–ç•¥
```typescript
// è·¯ç”±çº§ä»£ç åˆ†å‰²
const DashboardPage = lazy(() => import('./pages/DashboardPage'));
const AnalysisPage = lazy(() => import('./pages/AnalysisPage'));

// ç»„ä»¶çº§ä»£ç åˆ†å‰²
const HeavyChart = lazy(() => import('./components/HeavyChart'));

// æ¡ä»¶åŠ è½½
const AdminPanel = lazy(() => 
  import('./components/AdminPanel').then(module => ({
    default: module.AdminPanel
  }))
);
```

#### è™šæ‹Ÿæ»šåŠ¨å®ç°
```typescript
// å¤§æ•°æ®è¡¨æ ¼è™šæ‹Ÿæ»šåŠ¨
class VirtualTable {
  private visibleRange: { start: number; end: number };
  private itemHeight: number = 40;
  private containerHeight: number;
  
  calculateVisibleItems(scrollTop: number): void {
    const start = Math.floor(scrollTop / this.itemHeight);
    const visibleCount = Math.ceil(this.containerHeight / this.itemHeight);
    const end = Math.min(start + visibleCount + 5, this.totalItems); // 5ä¸ªç¼“å†²é¡¹
    
    this.visibleRange = { start, end };
  }
}
```

### 5.2 åç«¯æ€§èƒ½ä¼˜åŒ–

#### æ•°æ®é¢„èšåˆ
```typescript
// é¢„èšåˆä»»åŠ¡è°ƒåº¦å™¨
class PreAggregationScheduler {
  private tasks: PreAggregationTask[] = [];
  
  // æ³¨å†Œé¢„èšåˆä»»åŠ¡
  registerTask(task: PreAggregationTask): void {
    this.tasks.push(task);
  }
  
  // æ‰§è¡Œé¢„èšåˆ
  async runPreAggregation(): Promise<void> {
    for (const task of this.tasks) {
      try {
        const result = await task.execute();
        await this.savePreAggregatedData(task.key, result);
        console.log(`é¢„èšåˆå®Œæˆ: ${task.name}`);
      } catch (error) {
        console.error(`é¢„èšåˆå¤±è´¥: ${task.name}`, error);
      }
    }
  }
}
```

## 6. å®‰å…¨æ¶æ„

### 6.1 æ•°æ®å®‰å…¨
- **è®¿é—®æ§åˆ¶**: åŸºäºè§’è‰²çš„æƒé™ç®¡ç†
- **æ•°æ®è„±æ•**: æ•æ„Ÿæ•°æ®å±•ç¤ºè„±æ•å¤„ç†
- **å®¡è®¡æ—¥å¿—**: å®Œæ•´çš„æ“ä½œæ—¥å¿—è®°å½•
- **æ•°æ®å¤‡ä»½**: å®šæœŸæ•°æ®å¤‡ä»½å’Œæ¢å¤æœºåˆ¶

### 6.2 åº”ç”¨å®‰å…¨
- **è¾“å…¥éªŒè¯**: ä¸¥æ ¼çš„è¾“å…¥å‚æ•°éªŒè¯
- **XSSé˜²æŠ¤**: è¾“å‡ºå†…å®¹è½¬ä¹‰å’ŒCSPç­–ç•¥
- **CSRFé˜²æŠ¤**: TokenéªŒè¯æœºåˆ¶
- **è¯·æ±‚é™æµ**: APIè¯·æ±‚é¢‘ç‡é™åˆ¶

## 7. ç›‘æ§æ¶æ„

### 7.1 æ€§èƒ½ç›‘æ§
```typescript
// æ€§èƒ½ç›‘æ§å™¨
class PerformanceMonitor {
  // è®°å½•APIå“åº”æ—¶é—´
  recordAPILatency(endpoint: string, duration: number): void {
    const metric = {
      timestamp: Date.now(),
      endpoint,
      duration,
      type: 'api_latency'
    };
    
    this.sendMetric(metric);
  }
  
  // è®°å½•å†…å­˜ä½¿ç”¨
  recordMemoryUsage(): void {
    const usage = process.memoryUsage();
    const metric = {
      timestamp: Date.now(),
      heapUsed: usage.heapUsed,
      heapTotal: usage.heapTotal,
      type: 'memory_usage'
    };
    
    this.sendMetric(metric);
  }
}
```

### 7.2 ä¸šåŠ¡ç›‘æ§
- **ç”¨æˆ·è¡Œä¸º**: é¡µé¢è®¿é—®ã€åŠŸèƒ½ä½¿ç”¨ç»Ÿè®¡
- **æ•°æ®è´¨é‡**: æ•°æ®å®Œæ•´æ€§ã€å‡†ç¡®æ€§ç›‘æ§
- **ç³»ç»Ÿå¥åº·**: æœåŠ¡å¯ç”¨æ€§ã€é”™è¯¯ç‡ç›‘æ§
- **æ€§èƒ½æŒ‡æ ‡**: å“åº”æ—¶é—´ã€ååé‡ç›‘æ§

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**æœ€åæ›´æ–°**: 2025-01-16  
**ç»´æŠ¤äººå‘˜**: æŠ€æœ¯å›¢é˜Ÿ